<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master">

<tal:block metal:fill-slot="head_slot">
   <tal:block tal:define="dummy python:request.set('disable_border',1)" />
</tal:block>

<body>

<div metal:fill-slot="main"
     tal:define="userid python:request.get('userid', member.getId());
                user python:mtool.getMemberById(userid);
                mdata here/portal_memberdata;
                errors python:request.get('errors', {});
                Batch python:modules['ZTUtils'].Batch;
                b_start python:request.get('b_start',0);"
     tal:condition="here/rejectAnonymous" >

<!-- ugly way of simulating real actions on the groups/user pages until we have
     real objects. -->
<div id="contentTabs"> 
    <a class="" 
       href=""
       tal:attributes="href string: prefs_user_details?userid=${userid}"
    >User</a>
    <a class="selected"         
       href=""
       tal:attributes="href string:${template/id}?userid=${userid}"
    >Group Membership</a>
</div>
<div id="contentBar">&nbsp;</div>
<!-- End of tabs -->

<div class="document editable">    
	
    <h1 i18n:translate="">Group Membership for <span tal:replace="string: ${user/getId}"/></h1>

    <p i18n:translate="">
    This user is a member of the following groups:
    </p>

    <form action=""
          name="groups"
          method="post"
          tal:attributes="action here/absolute_url">


       <input class="standalone add"
              type="submit" 
              name="prefs_user_group_search_form" 
              value="Add New Group Membership" />

        <input type="hidden" name="userid" value="userid" 
               tal:attributes="value user/getId" />
               

        <table class="listing">
               
            <tr>
	      <th>Group name</th>
	      <th>Remove Group</th>
            </tr>

	  <tr tal:repeat="groupid user/getGroups" class="odd">
<!-- FIXME: the memberdata tool ought to wrap the groups for us so we -->
<!-- don't need to do this -->
	      <tal:block tal:define="group python:here.portal_groups.getGroupById(groupid);
		                     groupname group/getGroupName">
            <td>
                <a href="prefs_group_details"
                   tal:attributes="href string:prefs_group_details?groupname=$groupname">
		    <img src=""
                         tal:replace="structure portal/group.gif" />&nbsp;<span 
                         tal:replace="groupname">group name</span>
                </a>
            </td>
            
            
            <td class="checkbox">
                <input type="checkbox"
                       class="noborder notify"
                       name="delete:list"
                       tal:attributes="value groupname" />
            </td>
            </tal:block>
        </tr>
        
        </table>

        <input class="destructive"
               type="submit"
               name="prefs_user_membership_edit:method"
               value="Remove selected groups" />
	</form>
<!-- End dead code -->
      </div>
    </div>
  </body>
</html>