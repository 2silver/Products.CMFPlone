<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master">
<body>

<span metal:fill-slot="main"
       tal:define="results python:container.portal_catalog(request);
                 Batch python:modules['ZTUtils'].Batch;
                 DateTime python:modules['DateTime'].DateTime;
                 b_size python:30;b_start python:0;b_start request/b_start | b_start;">

    <div tal:condition="results"
          tal:define="batch python:Batch(results, b_size, int(b_start), orphan=1);
                      mq python:modules['ZTUtils'].make_query;
                      mhi python:modules['ZTUtils'].make_hidden_input">

        <strong> Found <span tal:replace="python:len(results)" /> items matching your criteria. </strong> <br/>
        <p>Item descriptions are shown below. Click the link go to the item.</p>
        
        <!-- Navigation -->
        <div class="listingBar">
            <span class="previous" 
              tal:define="p batch/previous | nothing" 
              tal:condition="p"> 
                <a href=""
                   tal:attributes="href python: '?' + mq( request.form, b_start=p.first )">
                   &laquo; Previous <span tal:replace="p/length">n</span> items
                </a>
            </span>
                
            <span class="next" 
              tal:define="n batch/next | nothing" 
              tal:condition="n">
                <a href=""
                   tal:attributes="href python: '?' + mq( request.form, b_start=n.first )">
                   Next <span tal:replace="n/length">n</span> items &raquo;
                </a>
            </span> 
        </div>

        <!-- Search results -->
        
        <table class="listing"
                tal:condition="here/contentValues">
        
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Author</th>
                    <th>Last Modified</th>
                    <th>Description</th>
                </tr>
            </thead>

            <tbody>
	        <metal:block tal:repeat="result batch">
                <tr class="even" 
		            tal:define="oddrow repeat/result/odd;
                                result_url result/getURL;
                                url string:$result_url/view;" 
		            tal:attributes="class python:test(oddrow, 'even', 'odd')" >
                    <td>
		                <img src="#" tal:attributes="src result/getIcon; alt result/Type;" />&nbsp;<a 
                         href="#" tal:attributes="href url"
                                  tal:content="result/title_or_id" />
                    </td>
                    <td tal:content="result/Creator">Author </td>
                    <td tal:content="result/ModificationDate">Modification Date</td>
                    <td tal:content="result/Description"> Description </td>
                </tr>
		</metal:block>
            </tbody>
        </table>

        <!-- Old Search results 
        <span tal:repeat="result batch">
            <div class="rowEven"
                 tal:define="rowodd repeat/result/odd;
                             result_url result/getURL;
                             url string:$result_url/view;"
                 tal:attributes="class python:test(rowodd, 'rowOdd', 'rowEven');" >

                <a href="/view" tal:attributes="href url">
                    <h2 tal:content="result/Title">
                    Title
                    </h2>
                </a>

                <img src="folder.gif" alt="Folder"
                     tal:attributes="src result/getIcon; alt result/Type;" />		

                by <a href="" tal:content="result/Creator" tal:attributes="href string:${here/portal_url}/Members/${result/Creator}">
                Creator </a>,

                last updated at <p tal:replace="python:container.toPortalTime(result.ModificationDate)" />

                <p tal:content="python:test(result.Description, result.Description, '(No Description)')">
                Description
                </p>
                
                <p>
                <a href="/view" tal:attributes="href url">
                Go to this item
                </a>
                </p>

            </div>
         </span>	
-->

        <!-- Navigation -->
        <div class="listingBar">
            <span class="previous" 
              tal:define="p batch/previous | nothing" 
              tal:condition="p"> 
                <a href=""
                   tal:attributes="href python: '?' + mq( request.form, b_start=p.first )">
                   &laquo; Previous <span tal:replace="p/length">n</span> items
                </a>
            </span>
                
            <span class="next" 
              tal:define="n batch/next | nothing" 
              tal:condition="n">
                <a href=""
                   tal:attributes="href python: '?' + mq( request.form, b_start=n.first )">
                   Next <span tal:replace="n/length">n</span> items &raquo;
                </a>
            </span> 
        </div>

    </div>
    
    <div tal:condition="not: results">
           <strong> No Results were Found </strong>
        </div>		 
     </span>


</body>
</html>
