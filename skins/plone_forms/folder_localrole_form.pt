<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master">
<body>

  <div metal:fill-slot="super">

        <div metal:use-macro="here/portal_tabs/macros/folderTabs">
        Content tabs
        </div>
        
        <div class="contentBar">        
        &nbsp;
        </div>	

  </div>
																																											
  <div metal:fill-slot="main"
    tal:define="join python:modules['string'].join;
    search_submitted request/role_submit|nothing;
    search_results python:test(search_submitted, here.portal_membership.searchMembers( search_param=request.get('search_param','')
                                                                                     , search_term=request.get('search_term', '') ), None);">

    <metal:block tal:condition="python:test(search_submitted and not search_results, 1, 0)">
		<h1 i18n:translate="">Search results</h1>
		<p i18n:translate="">No members were found using your <strong>Search Criteria</strong></p>
		<hr />
    </metal:block>
    
    <metal:block tal:condition="python:test(search_submitted and search_results, 1, 0)">
    
		<h1 i18n:translate="">Search results</h1>

		<p i18n:translate="">Select one or more Members, and a role to assign.</p>
	
	<form class="group"
              method="post" 
              name="change_type" 
              action="folder_localrole_edit">
 		
            <span class="legend" i18n:translate="">Available Members</span>
            
            <input type="hidden" name="change_type" value="add" />
		
		    <span class="card" tal:repeat="member search_results">
				
				<img src="defaultUser.gif" alt="Blank Picture"> <br />
				
				<input class="noborder" type="checkbox"
                       name="member_ids:list" value=""
                       tal:attributes="value member/username">
				<br />
				
				<strong tal:condition="python:member['username']"
                        tal:content="python:member['username']">
				username
				</strong>

				<br />
				
				<span tal:condition="python:member['email']"
                      tal:replace="python:member['email']">
				email
				</span>						    
		        
                <span tal:condition="python:not member['email']">&nbsp;</span>
		    </span>
		
		
    		<div class="row">
    				
    			<div class="label">
    			Role to assign
    			</div>
    
                <div class="field">
    
                    <select name="member_role">
    
                        <option tal:repeat="lroles python:container.portal_membership.getCandidateLocalRoles(here)"
                                tal:content="lroles">
    					Role name
                        </option>
    
                    </select>
    
                </div>
    
    		</div>

    		<div class="row">
    		
    			<div class="label">&nbsp;</div>
    			
    			<div class="field">
                    <input class="context" type="submit" value="Assign Local Role to Selected User(s)" />
                </div>
    		
    		</div>			
		
		</form>				


	</metal:block>

	
	<div>
		<span tal:condition="python:test(not search_submitted or (search_submitted and not search_results), 1, 0)">
 			<h1>
            <span i18n:translate="">Assign local roles to folder</span>
			<span tal:replace="here/title_or_id">title</span> 
			</h1>
			
			<p i18n:translate="">
			A local role is a way of allowing other users into some or all of your
			folders. These users can edit items, publish them - et cetera, depending
			on what permissions you give them.
			</p>
			
			<p i18n:translate="">
			Local roles are ideal in cooperation projects, and as every item has a
			history and an undo option, it's easy to keep track of the changes.
			</p>
			
			<p i18n:translate="">
			To give a person a local role in this folder, just search for the person's
			name or email address in the form below, and you will be presented with a
			page that will show you the options available.
			</p>
			
			<form class="group"
                  method="post" 
                  name="localrole" 
                  action="folder_localrole_form">
			
                <span class="legend" i18n:translate="">Search Terms</span>
			
                <input type="hidden" name="role_submit" value="role_submit" />
			
    			<div class="row">
    			
    				<div class="label">
    				Search by
    				</div>
    				
    				<div class="field">
    					<select name="search_param">
    						<option value="username">User Name</option>
    						<option value="email">Email Address</option>
    					</select>
    				</div>
    			
    			</div>
    			
    			<div class="row">
    			
    				<div class="label">
    				Search Term
    				</div>
    				
    				<div class="field">
    					<input type="text" name="search_term" size="30" />
    				</div>
    			
    			</div>
    
    			<div class="row">
    			
    				<div class="label">&nbsp;</div>
    				
    				<div class="field">
    					<input class="context" type="submit" value="Perform Search" />
    				</div>
    			
    			</div>
            			
			</form>

	    </span>

	    <hr />

    	<h1>
        <span i18n:translate="">Currently assigned local roles in folder</span>
    		<span tal:replace="here/title_or_id">title</span>
    	</h1>
    
    	<p i18n:translate="">
        These users currently have local roles assigned in this folder:
        </p>
    
    	<form class="group"
              method="post" 
              name="deleterole" 
              action="folder_localrole_edit">

            <span class="legend" i18n:translate="">Assigned Roles</span>

	        <input type="hidden" name="change_type" value="delete">
	        <input type="hidden" name="member_role" value="">

	
        	<div class="row">
        	
        	
        	    <span class="card" tal:repeat="lrole here/get_local_roles"
                      tal:define="username python:container.portal_membership.getAuthenticatedMember().getUserName()">
        		
        
            		<span>
            			<img src="defaultUser.gif" alt="Blank picture" />
            			<br />
            
            			<input class="noborder" type="checkbox"
            					name="member_ids:list" value="sequence-key"
            					tal:condition="python:lrole[0]!=username"
            					tal:attributes="value python:lrole[0]" />
            
            		</span>
            			
            		<br />
            		
            		<strong class="field" tal:content="python:lrole[0]">
            		sequence-key; 
            		</strong>
            
            		<br />
            			
            		Role(s): <br />	
            		
            		<span class="field"
            				tal:replace="python:join(lrole[1], ', ')">
            		_.string.join( _['sequence-item'], ', ')
            		</span>
        
            	</span>
        	
        	</div>

        	<div class="row">
        		
        		<div class="label">&nbsp;</div>
        		
        		<div class="field">
        			<input class="context" type="submit" value="Delete Selected Role(s)" />
        		</div>
        		
        	</div>
    
    	</form>

    </div>	


</div>
	   
</body>
</html>
