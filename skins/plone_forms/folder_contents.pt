<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      i18n:domain="plone"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main"
     tal:define="dummy here/filterCookie;
                 folderfilter python:request.get('folderfilter', '');
                 global decodedFilter python:here.decodeFolderFilter(folderfilter);
                 global filterValues decodedFilter;
                 global filter decodedFilter;
                 global portal_url here/portal_url;
                 global member here/portal_membership/getAuthenticatedMember;
                 standalone python:1;
                 Iterator python:modules['Products.CMFPlone'].IndexIterator;
                 tabindex python:Iterator();">

    <form name="folderContentsForm"
          method="post"
          action="folder_object"
          tal:attributes="action here/absolute_url"
          tal:define="global folder_contents python:here.listFolderContents( contentFilter=filter ); 
                      b_start python:request.get('b_start', 0);
                      results python:here.sortObjectValues(folder_contents);
                      global DateTime python:modules['DateTime'].DateTime;
                      Batch python:modules['ZTUtils'].Batch;
                      global batch python:Batch(results, 5000, int(b_start), orphan=0);">

        <input type="hidden" name="filter_state" value="set_view_filter" />
        
            <div class="title"> 
    
                <img tal:replace="structure here/folder.gif" /> 

                <span class="folderName" tal:condition="python:
user.getUserName()==here.getId()" i18n:translate="heading_my_folder">
                My Folder
                </span> 
                
                <span class="folderName" tal:condition="python: user.getUserName()!=here.getId()" tal:content="here/title_or_id">
                Directory Id
                </span> 
   
                <tal:block tal:define="parent_url python:here.navigationParent(here, template.getId());"
		           tal:condition="parent_url">
                (<a href="" 
                   tal:attributes="href parent_url" i18n:translate="go_to_parent_url">Up one level</a>)
                </tal:block>

            </div>
    
            <metal:block tal:condition="not: folder_contents">
            <p i18n:translate="description_no_visible_items_press_add">
            This folder has no visible items. To add content, press the "Add New Item" button,
            or paste content from another location.
            </p>						    
            </metal:block>
     
            <p tal:condition="python:user.getUserName()==here.getId()" 
                  i18n:translate="">
            Contains the items created and collected by <span tal:replace="python:user.getUserName()" i18n:name="name">User</span>
            </p> 

            <p tal:content="structure here/Description"
               tal:condition="python:not user.getUserName()==here.getId()">
               description
            </p>

            <table id="sortable"
                   class="listing"
                   summary="Content listing"
                   cellpadding="0" cellspacing="0"
                   metal:define-macro="folder_listing">
                   
                <thead >
                    <tr tal:condition="standalone|nothing">
                        <td class="top" colspan="6">

                            <!-- Filter pulldown -->
                            <span style="float: left"
                                  tal:define="filterValues decodedFilter/keys | nothing;
                                              types here/allowedContentTypes"
                                  tal:condition="here/listFolderContents">
                    
                                <select id="filter_selection" 
                                        name="filter_by_portal_type:list" 
                                        onChange="submitFilterAction()"
                                        tabindex=""
                                        tal:define="global filterTypes python:test( filterValues==nothing, types, here.filterTypes(filter));" 
                                        tal:attributes="tabindex tabindex/next|nothing;"
                                        >
                    
                                    <option value="#" 
                                            tal:attributes="selected
					    python:test((len(filterTypes)>1 or len(filterTypes)==0), 'selected', '');"
					    i18n:translate="label_show_all_items">
                                    Show All Items
                                    </option>  
                                    <metal:block tal:repeat="type types">
                                        <option value="#"
                                                tal:define="typetitle type/Title; typeid type/getId"
                                                i18n:translate=""
                                                tal:attributes="value typeid;
                                                                selected python:test( len(filterTypes)==1 and (typeid in filterTypes), 'selected', '');"
                                        ><span i18n:name="type" tal:content="string:${typetitle}"/>s only</option>
                                    </metal:block>
                                </select>
                    
                                <input type="hidden" name="filter_by_Subject:tokens" value="" />
                                <!--you can filter by subject keywords by filling in this value-->
                            </span>
                            
                        <metal:block tal:define="allowedContentTypes here/allowedContentTypes"
                            tal:condition="allowedContentTypes">
                            <!-- Add Item pulldown -->
                            <select name="type_name" 
                                    tabindex=""
                                    tal:attributes="tabindex tabindex/next|nothing;">
                                <option value="Select" i18n:translate="label_select">Select</option>
                                <metal:block tal:repeat="ctype allowedContentTypes"
                                             tal:define="global filterOut  python:['Favorite']">
                                <option value="Document"
                                        tal:condition="python: ctype.getId() not in filterOut"
                                        tal:attributes="value ctype/getId"
                                        tal:content="ctype/Title"
                                        i18n:translate="">Document</option>
                                </metal:block>
                            </select>
                
                            <input class="standalone" 
                                   type="submit" 
                                   name="folder_factories:method" 
                                   value="Add New Item"
                                   tabindex=""
                                   i18n:attributes="value"
                                   tal:attributes="tabindex tabindex/next|nothing;" 
                                   />
                        </metal:block>
            
                        </td>
                    </tr> 

                    <metal:block tal:condition="folder_contents|not:standalone|nothing">
                    <tr>
                        <th name="nosort"><input class="noborder" 
                                                 type="image"
                                                 src="select_all_icon.gif" 
                                                 name="selectButton"
                                                 title="Select all items"
                                                 onClick="toggleSelect(this); return false;"
                                                 /></th>
                        <th><span tal:omit-tag=""
                        i18n:translate="listingheader_title">Title</span>&nbsp;<img tal:replace="structure here/arrowUp.gif" /></th>
                        <th i18n:translate="listingheader_type">Type</th>
                        <th i18n:translate="listingheader_size">Size</th>
                        <th i18n:translate="listingheader_modified">Modified</th>
                        <th i18n:translate="listingheader_status">Status</th>
                    </tr>
                    </metal:block>
                </thead>

                <metal:block tal:condition="folder_contents|not:standalone|nothing">
                <tbody>
                <metal:block tal:repeat="item batch"> 
                    <tr border="1"
                        tal:define="oddrow repeat/item/odd"
                        tal:attributes="class python:test(oddrow, 'even', 'odd')" > 
    
                        <td>
                            <input type="checkbox" class="noborder" name="ids:list" id="#"
                                   value="#"
                                   tal:attributes="value item/getId;
                                                   id python: 'cb_'+item.getId();
                                                   checked request/ids_checked|nothing;
                                                   tabindex tabindex/next|nothing"/>
                        </td>
    
                        <td tal:define="action python:item.getTypeInfo().getActionById('view');
                                        url python:test(action, item.absolute_url()+'/'+action, item.absolute_url()+'/folder_contents');"> 
    
                            <a href="#" tal:attributes="href url">
                                <img tal:replace="structure python:path('here/%s' % item.getIcon(1))" 
                                />&nbsp;<span tal:replace="item/title_or_id">Title</span>
                            </a>
                            <tal:block tal:condition="python:test(here.portal_url.getPortalObject().getProperty('ext_editor') and item.hasActionId('external_edit'), 1,0)">

                            <a href="absolute_url/external_edit"
                               tal:attributes="href string:${item/absolute_url}/external_edit"
                               tal:define="edit here/edit.gif">
                               
                               <img tal:replace="structure python:edit.tag(title='Edit with External Editor')" />
                             </a>
                            </tal:block>
    
                          <span class="expired"
                                tal:condition="python:container.isExpired(item)">expired</span>
                        </td>
    
                        <td tal:content="python:item.getTypeInfo().Title()">
                        folder
                        </td>
    
                        <td tal:define="size python:here.getObjSize(item)"
                            tal:content="structure python:test(size, size, '&nbsp;')">
                        size
                        </td>
    
                        <td tal:content="python:here.toPortalTime(item.ModificationDate())">
                        08/19/2001 03:01 AM 
                        </td>
    
                        <td class="private"
                            tal:define="review_state python:container.portal_workflow.getInfoFor(item, 'review_state', '')"
                            tal:content="structure python:test(review_state, review_state, '&nbsp;')"
                            tal:attributes="class python:test(review_state, review_state, 'private')"
                            i18n:translate="">&nbsp;
                        </td>
                    </tr>
                </metal:block>
                </tbody>
                </metal:block> 
            </table>
    

            <tal:block tal:repeat="button actions/folder_buttons|nothing">
            <input class="context" 
	               type="submit" 
	               name="" 
                   value="" 
                   tabindex=""
                   tal:condition="python:folder_contents or (here.cb_dataValid and button['id'] == 'paste')"
                   i18n:attributes="value"
                   tal:attributes="value button/name; 
                                   name button/url;
                                   tabindex tabindex/next;" />
           </tal:block>   

   
    </form>

</div>


</body>
</html>
