<html>
	<head>
		<title>User/Group Search Macro(s)</title>
	</head>
	<body>

    <div metal:define-macro="user_group_search">
      <form action=""
          name="groups"
          method="post"
          tal:attributes="action here/absolute_url"
	  tal:define="Batch python:modules['Products.CMFPlone'].Batch;
                      b_start request/b_start | python:0;
                      b_size python:15;
                      searchstring request/searchstring | nothing;
	              searchonly searchonly | nothing;
                      results python:here.prefs_user_group_search(searchstring, searchonly);
                      batch python:Batch(results, b_size, int(b_start), orphan=1)">

	<span metal:define-slot="hiddens" />
	
        <table class="listing">
	  <tr>
	    <th colspan="6">
	      <span tal:omit-tag="" i18n:translate="label_quick_search">Quick search</span>:
                    <input class="quickSearch"
                           tabindex=""
                           type="text"
                           name="searchstring"
                           value=""
                           tal:attributes="value searchstring;
		                           tabindex tabindex/next;"
                           />
                
                    <input type="hidden" name="searchonly" value="groups" />
                    <input type="submit"
                           name="prefs_user_group_search_form"
                           value="Search"
                           tabindex=""
                           i18n:attributes="value"
                           tal:attributes="name string:${template/id}:method;
		                           tabindex tabindex/next;" />

	    </th>
	  </tr>
	  <tr>
	    <th tal:condition="takeaction | nothing">&nbsp;</th>
	    <th i18n:translate="listingheader_group_name">Name</th>
	  </tr>

	  <tr tal:condition="not:batch">
	    <td colspan="6">No matches</td>
	  </tr>

	  <tal:block repeat="obj batch">

            <tr tal:define="oddrow repeat/obj/odd"
	        tal:attributes="class python:test(oddrow,'odd','even')">

	      <td class="listingCheckbox">
                <input type="checkbox"
                       class="noborder notify"
                       name="add:list"
                       value="value"
		       tal:attributes="value obj/getGroupId | obj/getId" />
	      </td>

	      <td>
		<tal:block tal:condition="obj/getGroupName | nothing">
		  <img src="group.gif" />
		  <a href="" tal:attributes="href string:prefs_group_details?groupname=${obj/getGroupName}"
			tal:content="obj/getGroupName | default"
                        i18n:translate="link_groupname_not_available">
			groupname not available
		  </a>
		</tal:block>
		<tal:block tal:condition="not:obj/getGroupName | nothing">
		  <img src="user.gif" />
		  <a href="" tal:attributes="href string:prefs_user_details?userid=${obj/getId}"
			tal:content="obj/getUserName | default"
                        i18n:translate="link_username_not_available">
			username not available
		  </a>
		</tal:block>
	      </td>
	    </tr>
	  </tal:block>
        </table>

	<div metal:use-macro="here/batch_macros/macros/navigation" />
	
	<metal:block metal:define-slot="actions" >
        <input class="context"
               tabindex=""
               type="submit"
               name="addingaction"
               value="Use Selected..."
	       tal:condition="batch"
               tal:attributes="tabindex tabindex/next;"
               i18n:attributes="value" />
	</metal:block>

	<metal:block metal:define-slot="removables" />
    </form>
    </div>
  </body>
</html>
