<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="plone">

<metal:block metal:fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<body>

<div metal:fill-slot="prefs_configlet_main"
     tal:define="errors options/state/getErrors;">

<tal:disabled tal:condition="nothing">
<!-- I couldn't use the javascript_head_slot from this template, so I put it here -->
<script type="text/javascript">
<!--
registerPloneFunction(
    function() {
        var nodes = cssQuery('#searchtypes-field ul li');
        sortNodes(nodes, getInnerTextFast);
    }
);
//-->
</script>
</tal:disabled>

    <h1 i18n:translate="heading_search_setup">Search Settings</h1>

    <a href=""
       class="link-parent"
       tal:attributes="href string: $portal_url/plone_control_panel"
       i18n:translate="label_up_to_plone_setup">
    Up to Site Setup
    </a>

    <p class="documentDescription" 
       i18n:translate="description_search_setup">
       Search settings for Site.
    </p>

    <form action=""
          name="search"
          method="post"
          tal:attributes="action string:${here/absolute_url}/${template/getId}">

        <fieldset>
            <legend i18n:translate="legend_search_details">Search details</legend>
    
            <div class="field"
                 tal:define="enable_livesearch request/enable_livesearch | site_properties/enable_livesearch;
                             error errors/enable_livesearch | nothing;"
                 tal:attributes="class python:test(error, 'field error', 'field')">

                <input type="checkbox"
                       class="noborder"
                       name="enable_livesearch"
                       value="1"
                       id="cb_enable_livesearch"
                       tabindex=""
                       tal:attributes="tabindex tabindex;
                                       checked enable_livesearch;"
                       /> 
    
                <label for="enable_livesearch" 
                    i18n:translate="label_livesearch_enable">Enable LiveSearch</label>
    
                <div class="formHelp" id="livesearch_help"
                     i18n:translate="help_livesearch">
                     Enable the LiveSearch feature (like Google) to see live
                     results if the Browser supports the JavaScript.
                </div>
    
                <div tal:content="error">Validation error output</div>
    
            </div>
        <div class="field" id="searchtypes-field"
             tal:define="
                   portal_types     portal/portal_types;
                   allTypes         python:[portal_types.getTypeInfo(t) for t in here.getPortalTypes()];
                   typeLists        python:here.createMultiColumnList(allTypes, numCols=3, sort_on='title_or_id');
                   blacklisted      site_properties/types_not_searched;
                   searchTypes      python:[t.getId() for t in allTypes if t.getId() not in blacklisted];">
                <label i18n:translate="label_search_types">Define the types to be searched</label>
                <div class="formHelp" id="seachtypes_help"
                     i18n:translate="help_searchtypes">
                     Define the types that should searched when you use the searchbox.
                     Note that if new content types are installed, they will be enabled
                     for search by default unless explicitly turned off here or by the
                     relevant installer.
                </div>
                    <div style="float:left; margin-right: 2em;" tal:repeat="sublist typeLists">
                   <ul class="configlets">
                     <li tal:repeat="ptypeInfo sublist">
                       <input class="noborder"
                           type="checkbox"
                           name="portaltypes:list"
                           tal:attributes="value ptypeInfo/getId;
                                           id python:putils.normalizeString(ptypeInfo.getId());
                                           checked python:test(ptypeInfo.getId() in searchTypes,'checked','');" />
                       <label for=""
                           i18n:translate=""
                           tal:attributes="for python:putils.normalizeString(ptypeInfo.getId())"
                           tal:content="ptypeInfo/Title"
                           />
                    </li>
                   </ul>
                </div>

                <div class="visualClear"><!-- --></div>
            </div>
            <div class="formControls">
                <input class="context"
                       tabindex=""
                       type="submit"
                       name="form.button.Save"
                       value="Save"
                       i18n:attributes="value label_save;"
                       tal:attributes="tabindex tabindex/next;"
                       />
            </div>
    
        </fieldset>

        <input type="hidden" name="form.submitted" value="1" />

    </form>

</div>

</body>
</html>


