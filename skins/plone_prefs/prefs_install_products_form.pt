<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/prefs_main_template/macros/master">

<tal:block metal:fill-slot="head_slot">
   <tal:block tal:define="dummy python:request.set('disable_border',1)" />
</tal:block>

<body>


<div metal:fill-slot="prefs_configlet_main" i18n:domain="plone" tal:define="QI python:here.portal_url.getPortalObject().portal_quickinstaller">
    <h2 i18n:translate="heading_install_products_available"> Products available for install </h2>
    <form action="installProducts" tal:attributes="action python:QI.absolute_url()+'/installProducts'" method="POST">

        <table >
            <tr tal:repeat="product QI/listInstallableProducts">
                <td><input class="noborder"
                           type="checkbox"
                           name="products:list"
                           tal:attributes="value product/id"
                           /></td>
                <td tal:define="pid product/id" >  
                    <span tal:condition="python:not container.portal_quickinstaller.getProductFile(pid)" tal:content="pid">product</span>
                    <a tal:condition="python:container.portal_quickinstaller.getProductFile(pid)" tal:attributes="href string:${QI/absolute_url}/prefs_install_product_readme?filereadme=${product/id}" tal:content="pid">product</a>
                  </td> 
                <td><a tal:condition="product/hasError" tal:attributes="href string:${QI/absolute_url}/${product/id}/prefs_installed_product_overview">
                        <img  src="/misc_/PageTemplates/exclamation.gif"/></a>
                </td>
                <td tal:content="python:QI.getProductVersion(product['id'])"> </td>
            </tr>
        </table>
        <input class="context"
               type="submit"
               i18n:attributes="value"
               value="Install"
               />
    </form>

    <h2 i18n:translate="heading_install_products_installed"> Installed products </h2>
    <form action="uninstallProducts" tal:attributes="action python:QI.absolute_url()" method="POST">

        <table >
            <tal:block tal:repeat="product QI/listInstalledProducts">
                <tr tal:define="prodver python:QI.getProductVersion(product['id'])" tal:condition="python: not product['isHidden'] and not product['isLocked']" >
                    <td><input class="noborder"
                               type="checkbox"
                               name="products:list" tal:attributes="value product/id"
                               tal:condition="not: product/isLocked"
                               /></td>
                    <td>
                         <span tal:content="product/id" >product name</span>
    
                         (<a tal:attributes="href string:${QI/absolute_url}/${product/id}/prefs_installed_product_overview"
                             i18n:translate="link_install_products_log">Install log</a>)
    
                    </td>
                    <td tal:content="product/installedVersion" >product version
                    </td>
                    <td tal:condition="python:QI.isProductAvailable(product['id'])"> 
                         <a tal:condition="python:prodver != product['installedVersion']" 
                            tal:attributes="href string:${QI/absolute_url}/reinstallProducts?products=${product/id}"
                            i18n:translate="label_outdated_product_reinstall"> this product is outdated, click here to reinstall </a>
                    </td>
                    <td tal:condition="python:not QI.isProductAvailable(product['id'])"> <font color="#ff0000" i18n:translate="text_product_unavailable" >removed from Products folder</font></td>
                </tr>
            </tal:block>
        </table>
        <input class="context"
               type="submit"
               i18n:attributes="value"
               value="Uninstall"
               name="uninstallProducts:method"
               />
    </form>
</div>

</body>
</html>
