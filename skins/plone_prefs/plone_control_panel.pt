<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="plone">

<metal:block fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<body>

   <div metal:fill-slot="prefs_configlet_main"
      tal:define="controlPanel python:modules['Products.CMFCore.utils'].getToolByName(here, 'portal_controlpanel');
                  groups python:controlPanel.getGroups('site');
                  getIconFor nocall:putils/getIconFor">

    <h1 i18n:translate="heading_control_panel">Site Setup</h1>

    <div class="documentDescription" i18n:translate="description_control_panel">
      Configuration area for Plone and add-on Products.
    </div>

    <div tal:define="mt context/portal_migration;
                     sys mt/coreVersions;
                     mailhost context/MailHost/smtp_host|nothing;
                     mailfrom context/email_from_address|nothing">

        <p class="portalMessage"
           tal:condition="python:not (mailhost and mailfrom)"
           i18n:translate="text_no_mailhost_configured">
            Warning: You have not configured a mail host or a site 'From'
            address, various features including contact forms, email
            notification and password reset will not work.
        </p>

        <p class="portalMessage"
           tal:condition="not:sys/PIL"
           i18n:translate="text_no_pil_installed">
            Warning: PIL is not installed properly, image scaling will not work.
        </p>

    </div>

    <div class="visualClear"><!-- --></div>

    <tal:block tal:repeat="group groups">

        <h2 tal:content="group/title"
            i18n:translate="">Plone Configlet Group Title</h2>

        <div tal:define="allconfiglets python:controlPanel.enumConfiglets(group=group['id']);
                         configlets python:here.createMultiColumnList(allconfiglets, numCols=3);">

            <div tal:repeat="sublist configlets"
                 style="float:left; margin-right: 2em; width: 29%">

                <ul class="configlets">

                    <tal:configlet repeat="configlet sublist">
                        <li tal:condition="configlet/visible">
                            <a href=""          
                               tal:attributes="href configlet/url">
                                <img src="" alt="" tal:attributes="src python:getIconFor('controlpanel',configlet['id']);
                                                                   alt configlet/title;"
                                     i18n:attributes="alt"
                                     tal:on-error="string:" />
                            <tal:configletname tal:content="configlet/title"
                                               i18n:translate=""></tal:configletname>
                            </a>
                        </li>
                    </tal:configlet>

                </ul>

            </div>

            <div class="visualClear"><!-- --></div>

            <div tal:condition="not:allconfiglets"
                 i18n:translate="label_no_prefs_panels_available">
                No preference panels available.
            </div>

        </div>

    </tal:block>                        
    </div>

</body>
</html>
