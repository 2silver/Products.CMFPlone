<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="plone">

<metal:block fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<body>

<!--
we eventually might want to merge this form with personalize_form
-->

<div metal:fill-slot="prefs_configlet_content"
     tal:define="userid python:request.get('userid', member.getId());
                 member python:mtool.getMemberById(userid);
                 errors options/state/getErrors;">

      <div id="content" class="documentEditable">
    <!-- simulating views on the groups/user pages until we have real objects. -->
    <ul class="contentViews">
      <li class="selected">
            <a href=""
               tal:attributes="href string:${template/id}?userid=${userid}"
               i18n:translate="label_user_properties">
              User Properties
            </a>
      </li>
            
      <li class="">
            <a href=""
               tal:attributes="href string: prefs_user_memberships?userid=${userid}"
               i18n:translate="label_group_memberships">
              Group Memberships
            </a>
      </li>
    </ul>
    
    <div class="contentActions">
      &nbsp;
    </div>        
    
    <div class="documentContent" id="region-content">
      <a name="documentContent"></a>
      
      <div metal:use-macro="here/global_statusmessage/macros/portal_message">
        Portal status message
      </div>

      <div class="configlet">
        <h1 i18n:translate="heading_prefs_user_details">
          User Properties for
          <tal:username replace="member/getId | default"
                        i18n:name="username">username</tal:username>
        </h1>
    
        <a href=""
           class="link-parent"
           tal:attributes="href string: $portal_url/prefs_users_overview"
           i18n:translate="label_up_to_usersoverview">
          Up to Users Overview
        </a>

        <p i18n:translate="label_change_member_properties">
          Change member properties.
        </p>
    
        <form action=""
                  name="users"
                  method="post"
                  enctype="multipart/form-data"
                  tal:condition="user | nothing"
              tal:attributes="action template/getId">

          <fieldset>
            <legend i18n:translate="legend_member_details">Member Details</legend>
    
            <input type="hidden" name="userid" value="username"
                   tal:attributes="value member/getId" />
    
          <div class="row" tal:define="error errors/fullname| nothing;
                                   fullname python:request.get('fullname', member.getProperty('fullname', ''));"
                       tal:attributes="class python:test(error, 'field error', 'field')">
        <label i18n:translate="label_full_name">Full Name</label>
        <div class="formHelp" i18n:translate="help_full_name_creation">
          Enter full name, eg. John Smith.
        </div>

        <div tal:content="error">Validation error output</div>
        <input type="text"
                   name="fullname"
                   size="30"
                   value="fullname"
                   tabindex=""
                   tal:attributes="value fullname;
                                   tabindex tabindex/next;"
                   />
          </div>

          <div class="field" tal:define="error errors/email | nothing;
                                      email python:request.get('email', member.getProperty('email',''));"
                                 tal:attributes="class python:test(error, 'field error', 'field')">

            <label i18n:translate="label_email">E-mail</label>

            <span class="fieldRequired" title="Required"
                  i18n:attributes="title title_required;"
                  i18n:translate="label_required">(Required)</span>

                  <div class="formHelp" i18n:translate="help_email_creation">
                    Enter an email address. This is necessary in case the password
                    is lost. We respect your privacy, and will not give the address
                    away to any third parties or expose it anywhere.
                  </div>

                  <div tal:content="error">Validation error output</div>

                  <input type="text"
                         name="email"
                         size="30"
                         tabindex=""
                         tal:attributes="value email;
                                         tabindex tabindex/next;"
                         />
          </div>

            <div class="field"
                 tal:define="wysiwyg_editor python:request.get('wysiwyg_editor',
                                                member.getProperty('wysiwyg_editor',''))">

                <label for="wysiwyg_editor" i18n:translate="label_content_editor">Content editor</label>

                <div class="formHelp" i18n:translate="help_content_editor">
                Select the content editor that you would like to use.
                Note that content editors often have specific browser
                requirements.
                </div>

                <select name="wysiwyg_editor"
                        id="wysiwyg_editor"
                        tabindex=""
                        tal:attributes="tabindex tabindex/next;">
                        <tal:block tal:repeat="editor site_properties/available_editors">
                        <option tal:condition="python:editor != 'None'"
                                value="None"
                                tal:attributes="value editor;
                                                selected python:test(editor==wysiwyg_editor, 'selected', None);"
                                tal:content="editor">
                        WYSIWYG-editor
                        </option>
                        <option tal:condition="python:editor == 'None'"
                                value="None"
                                tal:attributes="value editor;
                                                selected python:test(editor==wysiwyg_editor, 'selected', None);"
                                tal:content="editor"
                                i18n:translate="label_ordinary_content_editor">
                        Ordinary Form-based Editor (works in all browsers)
                        </option>
    
                        </tal:block>
                </select>
            </div>
            <div class="field"
                      tal:define="ext_editor python:request.get('ext_editor',
                                                                member.getProperty('ext_editor',''))">
                <input type="checkbox"
                       class="noborder"
                       name="ext_editor"
                       id="cb_ext_editor"
                       tal:attributes="tabindex tabindex/next;
                                       checked python:test(ext_editor, 'checked', None);"
                       />

                <label for="cb_ext_editor" i18n:translate="label_ext_editor">Enable external editing</label>
     
                 <div class="formHelp" i18n:translate="help_content_ext_editor">
                 When checked, an icon will be made visible on each page which allows
                 you to edit content locally. Ask your administrator for more information
                 when needed.
                 </div>
            </div>    
            <div class="field"
                 tal:define="listed python:request.get('listed', member.getProperty('listed',''));">
                <input type="checkbox"
                       class="noborder"
                       name="listed"
                       id="cb_listed"
                       tal:attributes="tabindex tabindex/next;
                                       checked python:test(listed, 'checked', None);"
                       />

                <label for="cb_listed" i18n:translate="label_listed_status">Listed in searches</label>

                <div class="formHelp" i18n:translate="help_listed_search">
                Determines if your user name is listed in member searches done on this site.
                </div>

            </div>

            <div class="field"
                 tal:define="portrait python:mtool.getPersonalPortrait(member.getId());">

                <label for="portrait" i18n:translate="label_portrait">Portrait</label>

                <img src="" alt=""
                     height="100"
                     width="75"
                     style="border: 1px solid black; float: right;"
                     tal:condition="portrait"
                     tal:attributes="src portrait/absolute_url"
                     />

                <div class="formHelp" i18n:translate="help_portrait">
                To add or change the portrait: click the "Browse" button;
                select a picture of yourself. Recommended image size is 75
                pixels wide by 100 pixels tall.
                </div>

                <input type="file"
                       name="portrait"
                       id="portrait"
                       size="20"
                       tabindex=""
                       tal:attributes="tabindex tabindex/next;"
                       />

                <br />

                <input class="noborder"
                    tabindex=""
                    type="checkbox"
                    id="pdelete"
                    value="Delete Portrait"
                    name="delete_portrait"
                    tal:attributes="tabindex tabindex/next;"
                    />
                <label for="pdelete" i18n:translate="label_delete_portrait">Delete Portrait</label>

            </div>

    
            <div class="formControls">
                    <input class="context"
                        tabindex=""
                        type="submit"
                        value="Save"
                        name="prefs_user_edit:method"
                        i18n:attributes="value label_save;"
                        tal:attributes="tabindex tabindex/next;"
                        />
            </div>
          </fieldset>
          <input type="hidden" name="form.submitted" value="1" />
        </form>

      </div>
    </div>
      </div>
    </div>
  </body>
</html>
