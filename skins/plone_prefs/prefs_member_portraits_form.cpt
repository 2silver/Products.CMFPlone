<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="plone">

<tal:block metal:fill-slot="head_slot">
   <tal:block tal:define="dummy python:request.set('disable_border',1)" />
</tal:block>

<body>

<div metal:fill-slot="prefs_configlet_main"
     tal:define="errors options/state/getErrors | nothing;">

    <h1 i18n:translate="heading_manage_member_portraits">Manage member portraits</h1>

    <p i18n:translate="description_manage_member_portraits">
      This is an overview over all member portraits
    </p>
    
    <form action=""
          name="reconfig"
          method="post"
          tal:attributes="action string:${template/getId}"
          >
        
        <fieldset>
            <legend i18n:translate="legend_manage_member_portraits_details">Manage member portraits</legend>
    
            <div class="field"
                 tal:define="ids request/ids | nothing;
                             error errors/ids | nothing;"
                 tal:attributes="class python:test(error, 'field error', 'field')">
    
    
                <label i18n:translate="label_remove_member_portrait">Remove member portrait</label>
    
                <span class="fieldRequired" title="Required">(Required)</span>
                
                <div class="formHelp" i18n:translate="help_remove_member_portrait">
                Remove one or more member portraits.
                </div> 
    
                <div tal:content="error">Validation error output</div>
    
              <table id="sortable"
                   class="listing"
                   summary="Content listing"
                   cellpadding="0" cellspacing="0">

                <thead>
                   <tr>
                      <th class="nosort"><input class="noborder"
                                                 type="checkbox"
                                                 src="select_all_icon.gif"
                                                 name="selectButton"
                                                 title="Select all items"
                                                 onClick="toggleSelect(this); return false;"
                                                 tal:attributes="src string:$portal_url/select_all_icon.gif"
                                                 alt="Select all items"
                                                 i18n:attributes="title alt"
                                                 /></th> 
                     <th>&nbsp;<span tal:omit-tag=""
                     i18n:translate="memberportraits_image">Image</span>&nbsp;</th> 
                     <th>&nbsp;<span tal:omit-tag=""
                     i18n:translate="memberportraits_login">Login</span>&nbsp;</th> 

                     <th>&nbsp;<span tal:omit-tag=""
                     i18n:translate="memberportraits_member">Member</span>&nbsp;</th> 
                   </tr>
                </thead>
                <tbody>
                <metal:block 
                    tal:define="listOfMembers python:mtool.listMembers()"
                    tal:repeat="aMember listOfMembers">
                    <tr tal:define="oddrow repeat/aMember/odd;
                                    memberId aMember/getId;
                                    memberName aMember/fullname;
                                    defaultPortrait mtool/default_portrait"
                        tal:attributes="class python:test(oddrow, 'even', 'odd')" >

                        <td>
                            <input type="checkbox" class="noborder" name="ids:list" id="#"
                                   value="#"
                                   tal:attributes="value memberId;
                                                   id python: 'cb_'+memberId;
                                                   checked request/ids_checked|nothing;
                                                   tabindex tabindex/next|nothing;
                                                   alt string:Select portrait of ${memberName};
                                                   title string:Select portrait of ${memberName};"
                                                   />
                        </td>
                        <td tal:define="portrait python:mtool.getPersonalPortrait(memberId)">
                          <img src="portrait"
                             tal:condition="python: portrait.getId() != defaultPortrait"
                             tal:attributes="src portrait/absolute_url;
                                             width portrait/width;
                                             height portrait/height;
                                             alt string:Potrait of ${memberName};
                                             title string:Potrait of ${memberName};"
                             />
                          <span tal:omit-tag=""
                               tal:condition="python:portrait.getId() == defaultPortrait"
                               i18n:translate="memberportraits_emptyportrait">
                               no portrait
                           </span>
                               
                        </td>
                        <td>
                          <tal:content tal:content="memberId"/>
                        </td>
                        <td>
                          <tal:content tal:content="memberName"/>
                        </td>
                      </tr>
                </metal:block>
                </tbody>
            </table>
            </div>
            
            <div class="formControls">
                <input class="context"
                       tabindex=""
                       type="submit"
                       name="form.button.Save"
                       value="Save"
                       i18n:attributes="value"
                       tal:attributes="tabindex tabindex/next;"
                       />
                <input class="standalone"
                       tabindex=""
                       type="submit"
                       name="form.button.Cancel"
                       value="Cancel"
                       i18n:attributes="value"
                       tal:attributes="tabindex tabindex/next;"
                       />
            </div>
        
        </fieldset>
        
        <input type="hidden" name="form.submitted" value="1" />

    </form>

</div>

</body>
</html>

