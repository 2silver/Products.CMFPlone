<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="plone">

<metal:block metal:fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<body>

<div metal:fill-slot="prefs_configlet_main"
     tal:define="errors options/state/getErrors;
                 isSynAllowed here/portal_syndication/isSiteSyndicationAllowed">

    <h1 i18n:translate="heading_syndication_setup">Sitewide Syndication Setup</h1>

    <div tal:condition="isSynAllowed">

        <p i18n:translate="description_syndication_setup">
        Here you configure some of the settings that affect sitewide default syndication.
        </p>
          
          <form action=""
                name="reconfig"
                method="post"
                tal:attributes="action string:prefs_syndication_set"
                tal:define="props python:here.portal_properties;">
    
            <fieldset>
        
            <legend i18n:translate="legend_syndication_details">Syndication Details</legend>
    
            <div class="field">
                <label i18n:translate="label_syndication_updateperiod">Update period</label>
    
                <select name="updatePeriod" 
                        size="1"
                        tal:attributes="tabindex tabindex/next"
                        tal:define="upperiod here/portal_syndication/getUpdatePeriod">
    
                    <option tal:repeat="period here/portal_syndication/buildUpdatePeriods" 
                            tal:content="python:period[1]" 
                            tal:attributes="value python:period[0];
                                            selected python:test( upperiod==period[0],'selected' ,'')" />
                </select>
    
            </div>
    
            <div class="field"
                 tal:define="syndication_frequency request/updateFrequency | here/portal_syndication/getUpdateFrequency;
                             error_syndication_frequency nothing;"
                 tal:attributes="class python:test(error, 'field error', 'field')">
    
                <label i18n:translate="label_syndication_frequency">Update frequency</label>
    
                <div class="formHelp" i18n:translate="help_syndication_frequency">
                 Controls the frequency of the updates. For example, if you want it to 
                 update every second week, select "weekly" above, and "2" here.
                </div>
    
                <div tal:content="error">Validation error output</div>
    
                <input name="updateFrequency"
                       value=""
                       size="3"
                       tabindex=""
                       tal:attributes="value syndication_frequency;
                                       tabindex tabindex/next;" />
              </div>
    
            <div class="field"
                 tal:define="syndication_base request/updateFrequency | here/portal_syndication/getUpdateBase;
                             error_syndication_base nothing;"
                 tal:attributes="class python:test(error, 'field error', 'field')">
    
                <label i18n:translate="label_syndication_base">Update base</label>
    
                <div class="formHelp" i18n:translate="help_syndication_base">
                  Update base date (dummy description).
                </div>
    
                <div tal:content="error">Validation error output</div>
    
                <input name="updateBase:date"
                       value=""
                       size="70"
                       tabindex=""
                       tal:attributes="value syndication_base;
                                       tabindex tabindex/next;" />
            </div>
    
            <div class="field"
                 tal:define="syndication_maxitems request/max_items | here/portal_syndication/getMaxItems;
                             error_syndication_maxitems nothing;"
                 tal:attributes="class python:test(error, 'field error', 'field')">
    
                <label i18n:translate="label_syndication_maxitems">Max Syndicated Items </label>
    
                <div class="formHelp" i18n:translate="help_syndication_maxitems">
                  Max Syndicated Items.
                </div>
    
                <div tal:content="error">Validation error output</div>
    
                <input name="max_items"
                       value=""
                       size="3"
                       tabindex=""
                       tal:attributes="value syndication_maxitems;
                                       tabindex tabindex/next;" />
            </div>
    
            <div class="formControls">
                <input class="context"
                       tabindex=""
                       type="submit"
                       name="submit"
                       value="Save"
                       i18n:attributes="value label_save;"
                       tal:attributes="tabindex tabindex/next;"
                       />
                <input type="hidden" name="form_submitted" value="1" tal:attributes="value template/id" />
            </div>
          </fieldset>
        </form>
    
        <form action="" 
              method="post"
              tal:attributes="action string:prefs_syndication_set">
    
            <input type="submit" value="Disable Syndication" i18n:attributes="value label_disable_syndication;" />
            <input type="hidden" name="isAllowed:int" value="0" />
        </form>
    
    </div>

    <form action="" 
          method="post"
          tal:condition="not:isSynAllowed"
          tal:attributes="action string:prefs_syndication_set">
        <input class="standalone" type="submit" value="Enable Syndication"
               i18n:attributes="value label_enable_syndication;" />
        <input type="hidden" name="isAllowed:int" value="1" />

    </form>

</div>

</body>
</html>
