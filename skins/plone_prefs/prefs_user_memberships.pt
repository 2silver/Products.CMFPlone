<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master">

<tal:block metal:fill-slot="head_slot">
   <tal:block tal:define="dummy python:request.set('disable_border',1)" />
</tal:block>

<body>

<div metal:fill-slot="main"
     tal:define="userid python:request.get('userid', member.getId());
                user python:mtool.getMemberById(userid);
                mdata here/portal_memberdata;
                errors python:request.get('errors', {});
                Batch python:modules['ZTUtils'].Batch;
                b_start python:request.get('b_start',0);
		searchonly string:groups;
		takeaction string:prefs_user_membership_edit;"
     tal:condition="here/rejectAnonymous" >

<!-- ugly way of simulating real actions on the groups/user pages until we have
     real objects. -->
<ul id="contentTabs">
  <li class="">
    <a href=""
       tal:attributes="href string: prefs_user_details?userid=${userid}"
    >User</a>
  </li>
  <li class="selected">
    <a href=""
       tal:attributes="href string:${template/id}?userid=${userid}"
    >Group Membership</a>
  </li>
</ul>
<div id="contentBar">&nbsp;</div>
<!-- End of tabs -->

<div class="document editable">

    <h1 i18n:translate="">Group Membership for <span tal:replace="string: ${user/getId}"/></h1>

    <h3 i18n:translate="">
    Search for Groups to Join
    </h3>

    <div metal:use-macro="here/prefs_search_macros/macros/search">
         <span metal:fill-slot="hiddens">

        <input type="hidden" name="userid" value="userid"
		tal:attributes="value user/getId" />

	 </span>
    </div>

    <div metal:use-macro="here/prefs_search_macros/macros/display">
         <span metal:fill-slot="hiddens">

        <input type="hidden" name="userid" value="userid"
		tal:attributes="value user/getId" />

	 </span>

      <div metal:fill-slot="removables">
        <h3 i18n:translate="">
        Current Group Memberships
        </h3>

	<table class="listing">

            <tr>
	      <th>Group name</th>
	      <th>Remove Group</th>
            </tr>

	  <tr tal:repeat="groupid user/getGroups" class="odd">
	      <tal:block tal:define="group python:here.portal_groups.getGroupById(groupid);
		                     groupname group/getGroupName">
            <td>
                <a href="prefs_group_details"
                   tal:attributes="href string:prefs_group_details?groupname=$groupname">
		    <img src=""
                         tal:replace="structure portal/group.gif" />&nbsp;<span
                         tal:replace="groupname">group name</span>
                </a>
            </td>


            <td class="checkbox">
                <input type="checkbox"
                       class="noborder notify"
                       name="delete:list"
                       tal:attributes="value groupname" />
            </td>
            </tal:block>
        </tr>

        </table>

        <input class="destructive"
               type="submit"
               name="deleteaction"
               value="Remove selected groups" />
	  </div>

	</div>

      </div>
    </div>
  </body>
</html>
