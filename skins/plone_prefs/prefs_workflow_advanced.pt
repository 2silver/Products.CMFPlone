<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="plone">

<metal:block fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<body>

<div metal:fill-slot="prefs_configlet_main"
     tal:define="workflow_list wtool/listWorkflows">

<!-- ugly way of simulating real actions on the groups/user pages until we have
     real objects. -->

<ul id="contentTabs">
  <li class="">
    <a href="prefs_workflow_basic"
       i18n:translate="label_workflow_default">Default Workflow Configuration</a>
  </li>
  <li class="selected">
    <a href="prefs_workflow_advanced"
       i18n:translate="label_workflow_advanced">Advanced</a>
  </li>
</ul>
<div id="contentBar">&nbsp;</div>
<!-- End of tabs -->



     <metal:block tal:condition="python:test(request.get('type_name', 'Select')!='Select', 1, 0)">
        <tal:block tal:define="pps python:modules['Products.PythonScripts.standard'];
                               type_name python:pps.url_quote(request.get('type_name'));
                               " />
     </metal:block>

    <h1 i18n:translate="heading_select_workflow">Select workflow</h1>

    <p i18n:translate="description_select_workflow">
        Select the type of workflow you want for each different content type.
    </p>


    <form name="change_workflow" 
          action="prefs_workflow_advanced_edit" 
          method="post">

        <fieldset tal:define="allowedContentTypes python:here.sortObjects(here.allowedContentTypes())">

        <legend i18n:translate="legend_contenttypes">Content types</legend>


            <div class="field"
                tal:repeat="ctype allowedContentTypes"
                tal:define="Title ctype/Title;
                            Id ctype/getId;
                            current_wf python:wtool.getChainForPortalType(Id)[0]">

                <label tal:content="Title">Title</label>

                <img src=""
                    alt=""
                    width="16"
                    height="16"
                    tal:attributes="src string:$portal_url/${ctype/getIcon}" />

                <select id="select_workflow"
                        name="workflow_id"
                        tabindex=""
                        alt=""
                        tal:attributes="name python:'wf.' + ctype.getId() + ':record'" >
                    <option value="current"
                        tal:attributes="value current_wf"><span tal:replace="current_wf"/></option>
                    <metal:block tal:repeat="wf workflow_list">
                        <option value="wf"

                                tal:attributes="value wf"
                                tal:content="wf"
                                i18n:translate="">Simple workflow</option>
                    </metal:block>
                </select>

            </div>

            <div class="formControls">
                <input class="context"
                       tabindex=""
                       type="submit"
                       name="Change"
                       value="Save"
                       i18n:attributes="value"
                       tal:attributes="tabindex tabindex/next;" />
            </div>
        </fieldset>
    </form>

</div>

</body>
</html>
