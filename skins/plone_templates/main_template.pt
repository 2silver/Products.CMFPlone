<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" 
      xml:lang="en"
      lang="en" 
      metal:define-macro="master"
      tal:define="utool nocall:here/portal_url;
        mtool here/portal_membership;
        atool here/portal_actions;
        wtool here/portal_workflow;
        portal_object utool/getPortalObject;
        portal_title portal_object/Title;
        object_title here/Title;
        portal_url utool;
        portal nocall:portal_object;
        member mtool/getAuthenticatedMember;
        membersfolder mtool/getMembersFolder;
        isAnon mtool/isAnonymousUser;
        global actions python:here.portal_actions.listFilteredActionsFor(here);
        user_actions actions/user;
        object_actions actions/object;
        workflow_actions actions/workflow;
        folder_actions actions/folder;
        global_actions actions/global;
        wf_state python:wtool.getInfoFor(here,'review_state',None);
        site_properties here/portal_properties/site_properties;
        ztu modules/ZTUtils;
        actions options/actions|actions;
        obj_actions object_actions;
        wf_actions workflow_actions;
        local_actions python:actions.get('object_tabs', []);
        isFolder python:test(here.getTypeInfo().getId() in site_properties.use_folder_tabs,1,0);
        template_id options/template_id|template_id|template/getId|nothing;
        slots_mapping options/slots_mapping|template/prepare_slots|nothing;" 
      tal:attributes="lang site_properties/default_language|default;
                      xml:lang site_properties/default_language|default;">

<head metal:use-macro="here/header/macros/html_header">
  <metal:block metal:fill-slot="base">
    <metal:block metal:define-slot="base">
       <base href="" 
             tal:condition="here/isPrincipiaFolderish|nothing" 
             tal:attributes="href python:here.absolute_url()+'/'" />
       <metal:block tal:condition="not:here/isPrincipiaFolderish|nothing">
          <base href="" 
                tal:define="path python:'/'.join(here.portal_url.getRelativeContentPath(here)[:-1])"
                tal:attributes="href python:here.portal_url()+'/'+path+test(len(path)>0,'/','')" />
       </metal:block>
    </metal:block>
  </metal:block>
  
  <metal:block fill-slot="head_slot"
               tal:define="language here/Language;
	                   lang python:test(language, 
                                            language, 
                                            site_properties.default_language);
                           charset site_properties/default_charset|string:utf-8">
    <metal:block define-slot="head_slot" />
  </metal:block>
  
  <metal:block fill-slot="css_slot">
    <metal:block define-slot="css_slot" />
  </metal:block>

  <metal:block fill-slot="javascript_head_slot">
    <metal:block define-slot="javascript_head_slot" />
  </metal:block>
</head>

<body>

<div metal:use-macro="here/header/macros/portal_header">
Header stuff
</div>


<table class="columns">

    <tbody>
        <tr>
            <td class="left" metal:define-macro="left_column"
	                     tal:condition="slots_mapping/left|nothing">
                <metal:block tal:repeat="slot slots_mapping/left|slots_mapping/left">
                <tal:block tal:define="global pathexpr python:slot[0];
                                       global usemacro python:slot[1]"
                           tal:condition="usemacro">
                    <metal:block metal:use-macro="python:path(pathexpr)" />
                </tal:block>
                <span tal:condition="not: usemacro"
                      tal:replace="structure python:path(pathexpr)" />
                </metal:block>
            </td>
            <td class="main" 
                tal:define="global show_border python:here.showEditableBorder( template_id=template_id
                                                                             , actions=actions )">

                <metal:block define-slot="super"
		             tal:condition="show_border" >
                
                <div id="contentTabs" metal:define-macro="contentTabs"
                     i18n:domain="plone">
   
                    <tal:block tal:repeat="action python:test(isFolder, folder_actions+local_actions, obj_actions+local_actions)">
                        <a class="" href="" 
                           tal:attributes="class python:test(action['url'][action['url'].rfind('/')+1:]==template_id, 'selected', 'plain');
			                   href action/url;">
                            <span tal:omit-tag="" i18n:translate=""><span tal:replace="action/name">dummy</span></span>
                        </a> 
                    </tal:block>
    
                </div>

                <div id="contentBar">        
                &nbsp;
                </div>    
            
                </metal:block>
            
                <div class="document"
                     tal:attributes="class python:test(show_border, 'editableDocument', 'document')">

                    <div id="content">

                        <metal:block metal:use-macro="here/header/macros/portal_message">
                        Message box
                        </metal:block>
            
                        <div class="documentActions"
                             metal:define-macro="documentActions"
			     tal:define="portal_url portal_url|here/portal_url">
    
                            <metal:block define-slot="documentActions" 
			                 tal:content="nothing">
                            Document actions slot
                            </metal:block>                     
    
                            <a href=""
                               tal:condition="site_properties/allow_sendto | nothing"
                               tal:attributes="href python:'%s/portal_form/sendto_form' % here.absolute_url()">
                                <img i18n:attributes="title" alt="Send to"
                                     tal:attributes="src string:$portal_url/mail_icon.gif" 
                                     src="mail_icon.gif" title="Send this page to somebody" />
                            </a>
    
                            <a href="javascript:this.print();">
                                <img i18n:attributes="title" alt="Print"
                                     tal:attributes="src string:$portal_url/print_icon.gif" 
                                     src="print_icon.gif" title="Print this page" />
                            </a>
                        </div>
    
                        <metal:block metal:define-slot="header" tal:content="nothing">
                        Header slot 
                        </metal:block>
    
                        <metal:block metal:define-slot="main" tal:content="nothing">
                        Page body text 
                        </metal:block>
            
                        <metal:block metal:define-slot="sub">
                        <tal metal:use-macro="here/viewThreadsAtBottom/macros/discussionView" />
                        </metal:block> 
                    </div>
                </div>
            </td>

            <td class="right" tal:condition="slots_mapping/right">
                <metal:block tal:repeat="slot slots_mapping/right">
                    <tal:block tal:define="global pathexpr python:slot[0];
                                           global usemacro python:slot[1];"
                               tal:condition="usemacro">
                        <metal:block metal:use-macro="python:path(pathexpr)" />
                    </tal:block>
                    <span tal:condition="not: usemacro"
                          tal:replace="structure python:path(pathexpr)" />
                </metal:block>
            </td>
        </tr>
    </tbody>
</table>

<hr size="" class="netscape4" />

<div class="footer" metal:use-macro="here/footer/macros/portal_footer">
Footer
</div>

</body>
</html>
