<table metal:define-macro="navigationBox"
       i18n:domain="plone"
       tal:define="isContainer here/isPrincipiaFolderish|nothing;
                   parent_url python:here.navigationParent(here, template.getId());
                   siblings here/navigationCurrent;
                   showOtherNav python:0;
                   showNav python:0;
		   listContentsPermission python:here.portal_membership.checkPermission('List folder contents', here);
		   notFolderContents python:test(template.getId()!='folder_contents', 1, 0);
		   editorView python:test(listContentsPermission and notFolderContents, 1, 0);"
       tal:condition="python:test(siblings or editorView or parent_url , 1, 0)"
       class="box"
       summary="Navigation"
       cellpadding="0"
       cellspacing="0">

    <thead>
        <tr><th i18n:translate="">Navigation</th><th class="empty">&nbsp;</th></tr>
    </thead>

    <tbody>
        <tr class="odd">
            <td colspan="2">
            <strong tal:content="here/title_or_id">Current title</strong>
            </td>
        </tr>

        <tr class="even" tal:condition="siblings">
            <td colspan="2">
            <div>
                <strong i18n:translate="">Other items</strong> <br />
                <div tal:repeat="sibling siblings">
                    <metal:block tal:define="iscurrent python:test(sibling.getId()==here.getId(), 1, 0);
                                             sibling_title python:'&nbsp;;'.join(sibling.title_or_id()[:18].split(' '));">
                    <a href="#" class="plain"
                       tal:condition="not: iscurrent"
                       tal:define="url string:${sibling/absolute_url}/view"
                       tal:attributes="href url">
                        <img src="" 
                             height="16" 
                             width="16" 
                             alt="dummy"
                             border="0" 
                             tal:attributes="src string:$portal_url/${sibling/getIcon};
                                             alt sibling/Title;" />&nbsp;<tal:block tal:content="structure sibling_title" />
                    </a>
                    <tal:block tal:condition="iscurrent">
                      <img src=""
                           height="16"
                           border="0"
                           tal:replace="structure python:path('here/%s' % sibling.getIcon(1))" />&nbsp;<strong 
                               tal:content="structure sibling_title">
                               Current content id
                               </strong>
                    </tal:block>
                    </metal:block>
                </div>
            </div>
            </td>
        </tr>
        <tr class="odd" 
            tal:condition="parent_url">
            <td colspan="2">
                <a href="" 
                   tal:attributes="href parent_url">
                    <img tal:replace="structure here/linkTransparent.gif" />
                   <span i18n:translate="">Up one level</span></a>
            </td>
        </tr>

        <tr class="even"
            tal:condition="editorView">
            <td colspan="2"
                tal:condition="notFolderContents">

               <a href="folder_contents"
                  tal:condition="here/isPrincipiaFolderish">
                   <img tal:replace="structure here/linkTransparent.gif" />
                  <span i18n:translate="">Editor view</span>
               </a>
               
               <a href="../folder_contents"
                  tal:condition="not: here/isPrincipiaFolderish" 
                  tal:attributes="href string:${here/aq_parent/absolute_url}/folder_contents">
                   <img tal:replace="structure here/linkTransparent.gif" />
                  <span i18n:translate="">Editor view</span>
               </a>
            </td>
        </tr>

        <tr class="even"
            tal:condition="not: notFolderContents">
            <td colspan="2" >
                <a href="">
                   <img tal:replace="structure here/linkTransparent.gif" />
                <span i18n:translate="">Ordinary view</span>
                </a>
            </td>
        </tr>

    </tbody>

</table>
