<table metal:define-macro="navigationBox"
       tal:define="isContainer here/isPrincipiaFolderish|nothing;
                   parent_url python:here.navigationParent(here, template.getId());
                   siblings here/navigationCurrent;
                   showOtherNav python:0;
                   showNav python:0;
		   listContentsPermission python:here.portal_membership.checkPermission('List folder contents', here);
		   notFolderContents python:test(template.getId()!='folder_contents', 1, 0);
		   editorView python:test(listContentsPermission and notFolderContents, 1, 0);"
       tal:condition="python:test(siblings or editorView or parent_url, 1, 0)"
       class="box"
       summary="Navigation"
       cellpadding="0"
       cellspacing="0">

    <thead>
        <tr><th>Navigation</th><th class="empty">&nbsp;</th></tr>
    </thead>

    <tbody>
        <tr class="odd">
            <td colspan="2">
            <strong tal:content="here/title_or_id">Current title</strong>
            </td>
        </tr>

        <tr class="even" tal:condition="siblings">
            <td colspan="2">
            <div>
                <strong>Other items</strong> <br />
                <div tal:repeat="sibling siblings">
                    <a href="#" class="plain"
                     tal:define="actions python:here.portal_actions.listFilteredActionsFor(sibling);
                     action python:here.getActionUrlById('view', actions['object']);
                     url python:test(action, action,sibling.absolute_url()+'/folder_contents');"
                     tal:attributes="href url">
    		            <img src="" 
    			             height="16" 
    			             width="16"
                             alt="dummy" 
    			             tal:attributes="src sibling/getIcon;
                                             alt sibling/Type" />&nbsp;<span tal:replace="structure python:'&nbsp;'.join(here.truncID(sibling.title_or_id(), 18).split(' '))">
    			                                                            truncated content title whose white spaces are non-breaking
    			                                                          </span>
		            </a>
                </div>
            </div>
            </td>
        </tr>
        <tr class="odd" 
	    tal:condition="parent_url">
            <td colspan="2">
                <a class="marker" 
		   href="" 
		   tal:attributes="href parent_url">Up one level</a>
            </td>
        </tr>

        <tr class="even"
            tal:condition="editorView">
            <td colspan="2"
                tal:condition="notFolderContents">
               <a class="marker"
                  href="folder_contents"
                  tal:condition="here/isPrincipiaFolderish" 
                  >Editor view</a>
               <a class="marker"
                  href="../folder_contents"
                  tal:condition="not: here/isPrincipiaFolderish" 
                  tal:attributes="href string:${here/aq_parent/absolute_url}/folder_contents"
                  >Editor view</a>
            </td>
        </tr>

        <tr class="even"
            tal:condition="not: notFolderContents">
            <td colspan="2" >
                <a class="marker" href="">Ordinary view</a>
            </td>
        </tr>

    </tbody>

</table>
