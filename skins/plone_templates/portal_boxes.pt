<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

<head metal:use-macro="here/header/macros/html_header">

</head>


<!-- The content header, used on most content -->

<div metal:define-macro="contentHeader">

 	<h1 tal:content="here/title_or_id">Title or id</h1>

</div>


<!-- The default navigation box -->
 
<table metal:define-macro="navigationBox"
       tal:define="isContainer here/isPrincipiaFolderish|nothing;
                   parent_url python:here.navigationParent(here, template.getId());
                   siblings here/navigationCurrent;
                   showOtherNav python:0;
                   showNav python:0;
                   showOtherNav here/portal_url/CMFTopic_navigator | showNav"
       tal:condition="python:parent_url and not(showOtherNav)"
       class="box" summary="Navigation" cellpadding="0" cellspacing="0">
                   siblings here/navigationCurrent;"
       class="box" 
       summary="Navigation" 
       cellpadding="0" 
       cellspacing="0"
       tal:condition="python:test( (parent_url and here.portal_membership.isAnonymousUser()) or (not here.portal_membership.isAnonymousUser()), 1, 0)" >
  
    <thead>
        <tr><th>Navigation</th><th class="empty">&nbsp;</th></tr>
    </thead>

    <tbody tal:define="listContentsPermission python:here.portal_membership.checkPermission('List folder contents', here);
                       notFolderContents python:test(template.getId()!='folder_contents', 1, 0);">
        <tr class="odd">
            <td colspan="2">
            <strong tal:content="here/title_or_id">Current title</strong>
            </td>
        </tr>
        
        <tr class="even" tal:condition="siblings">
            <td colspan="2">
            <div>
                <strong>Other items</strong>
                <span tal:repeat="sibling siblings">
                    <a href="#" class="plain" 
                     tal:define="actions python:here.portal_actions.listFilteredActionsFor(sibling);
                     action python:here.getActionUrlById('view', actions['object']);
                     url python:test(action, action,sibling.absolute_url()+'/folder_contents');"
                     tal:attributes="href url"><img src="" height="16" width="16" tal:attributes="src sibling/getIcon"/>&nbsp;<span tal:replace="sibling/title_or_id"/></a>
                </span>
            </div>                                
            </td>
        </tr>
        
        <tr class="odd" tal:condition="parent_url">
            <td colspan="2">
                <a href="" tal:attributes="href parent_url">Up one level</a>
            </td>
        </tr>

        <tr class="even"  
            tal:condition="python:test(listContentsPermission and notFolderContents, 1, 0)">
            <td colspan="2" 
                tal:condition="notFolderContents">
                <a href="folder_contents">Editor view</a>
            </td>
        </tr>
        
        <tr class="even"  
            tal:condition="not: notFolderContents">
            <td colspan="2" >
                <a href="">Ordinary view</a>
            </td>
        </tr>
                
    </tbody>
        
</table>




<!-- The default Related Items box -->

<table metal:define-macro="relatedBox"
       tal:define="localContent here/navigationLocalRelated; 
                       remoteContent here/navigationRemoteResources;" 
       tal:condition="python:test(localContent or remoteContent, 1, 0)"
       class="box" summary="Related Items" cellpadding="0" cellspacing="0">
  
    <thead>
        <tr><th>Related</th><th class="empty">&nbsp;</th></tr>
    </thead>

    
    <!-- runyaga: need code that shows related items by keyword in top row, links in same folder in bottom row -->
    
    <tbody >
    
        <tr class="odd">
   
            <td colspan="2">

                <strong tal:condition="localContent">Local resources</strong>

                <span tal:repeat="content localContent">
                        <a href="" tal:attributes="href python:content[1]" tal:content="python:content[0]">
                           Object related by keyword
                        </a> 
                </span>

            </td>
   
        </tr>
        
        <tr class="even" tal:condition="remoteContent">
        
            <td colspan="2">

            <strong>External links</strong>
         
            <span tal:repeat="o remoteContent">       
                    <a href="" tal:attributes="href python:o[1]" tal:content="python:o[0]">Link object in same folder</a>
            </span>

            </td>
            
        </tr>
  
    </tbody>
        
</table>

<!-- The Login box -->

<table metal:define-macro="loginBox"
       class="box" cellpadding="0" cellspacing="0"
       summary="Login" 
       tal:condition="here/portal_membership/isAnonymousUser" >
  
    <thead>
        <tr><th>Sign in</th><th class="empty">&nbsp;</th></tr>
    </thead>
        
    <tbody>
        <tr class="odd">
            <td colspan="2">

                <form action="logged_in" method="post"
                      tal:attributes="action python: container.portal_url()+'/logged_in'">
    
            		<input type="hidden" name="came_from" value=""
            	       tal:condition="python:request.get('came_from', '')"
            	       tal:attributes="value request/came_from" />
    
                    <strong>Name:</strong> <br />
                    <input type="text" name="__ac_name" size="10"
    	        		 	 tal:attributes="value python:request.get('__ac_name', '')" />
                    
                    <br />
                    
                    <strong>Password:</strong>  <br />
                    <input type="password" name="__ac_password" size="10" />
    
                    <br />
                    &nbsp;
                    <br />
                    
                    
    				<input class="context" type="submit" name="submit" value="Sign in" />
                    
                </form>

            </td>
        </tr>
        
        <tr class="even">
            <td colspan="2">
                
                <a href="mail_password_form">
                Forgot your password?
                </a>

            </td>
        </tr>

        <tr class="odd" 
            tal:condition="python:here.portal_membership.checkPermission('Add portal member', here)" >
            <td colspan="2">
                            
                <a href="join_form">
                New user?
                </a>

            </td>
        </tr>
    </tbody>

</table>


<!-- The Favorites Box -->

<table metal:define-macro="favoritesBox"
       tal:define="folder python:getattr(here.portal_membership.getHomeFolder(), 'Favorites', None)"
       tal:condition="folder"
       class="box" summary="Favorites" cellpadding="0" cellspacing="0">

    <thead>
        <tr><th>My&nbsp;Favorites</th><th class="empty">&nbsp;</th></tr>
    </thead>

    
    <tbody>
        <tr class="odd">
            <td colspan="2">
            
                <strong>Favorites</strong>
    
                <span tal:repeat="o python:folder.objectValues(['Favorite'])">
                    <a tal:attributes="href o/getRemoteUrl" href="" tal:content="o/title_or_id">Favorite title</a>
                </span>
                
            </td>
        </tr>
        
        <tr class="even">
            <td colspan="2">

                <a href="" tal:attributes="href string:${folder/absolute_url}/folder_contents">Organize Favorites</a>

            </td>
        </tr>
    </tbody>
        
</table>


<!-- The news box -->

<table metal:define-macro="newsBox"
       class="box"
       summary="News listing" 
       cellpadding="0" cellspacing="0"
       tal:define="DateTime python:modules['DateTime'].DateTime;
                    results python:here.portal_catalog.searchResults( meta_type='News Item'
    													  , sort_on='Date'
    													  , sort_order='reverse'
    													  , review_state='published');"
        
       tal:condition="results">
  
    <thead>
        <tr><th>News</th><th class="empty">&nbsp;</th></tr>
    </thead>
        
    <tbody tal:repeat="obj results">
    
        <tr tal:define="oddrow repeat/obj/odd"
            tal:attributes="class python:test(oddrow, 'even', 'odd')"
            class="#">
   
            <td colspan="2">
                
                <a href="#"
                   tal:attributes="href python:obj.getObject().absolute_url()">
                    <span tal:replace="python:obj.getObject().Title()"> Extended Calendar Product </span>
                </a>
                
                <div class="boxDetails"
                     tal:content="python:DateTime(obj.getObject().ModificationDate()).strftime('%B %d, %H:%M')">July 7, 08:11</div>
            </td>
   
        </tr>
  
    </tbody>
        
</table>


<!-- The About box -->

<table metal:define-macro="aboutBox"
       class="box" 
       summary="About" cellpadding="0" cellspacing="0">
  
    <thead>
        <tr><th>About</th><th class="empty">&nbsp;</th></tr>
    </thead>
        
    <tbody>
        <tr class="odd">
            <td colspan="2">

            <img src="img/icons/folder.gif" alt=""
                 tal:attributes="src here/getIcon;
                 alt here/meta_type;" />&nbsp;<span tal:replace="python:here.getTypeInfo().Type()">Object type</span>
            </td>
        </tr>
                    
        <tr class="even">
            <td colspan="2">
            
            <strong>Created&nbsp;by:</strong> <br /> 
            <a href="#" tal:content="here/Creator" 
                        tal:attributes="href python:here.portal_membership.getHomeUrl(here.Creator())">bob</a>
            </td>
        </tr>
        
        <tr class="odd">
            <td colspan="2">
                <strong>Last&nbsp;modified:</strong> <br />
                <span tal:define="DateTime python:modules['DateTime'].DateTime;"
            	      tal:replace="python:DateTime(here.ModificationDate()).strftime('%d/%m %Y at %I:%M %p')">
                August 16, 2001 at 23:35:59
                </span>
            </td>
        </tr>
            
        <tr class="even">
            <td colspan="2">
                <strong>Status:</strong> <br />
                <span class="private"
                      tal:define="review_state python:container.portal_workflow.getInfoFor(here, 'review_state', '')"
            	      tal:content="review_state"
            	      tal:attributes="class review_state">
                </span>
        
                <span class="expired" tal:condition="python:container.isExpired(here)">
                (expired)
                </span>
            
            </td>
        </tr>
    </tbody>

</table>


<!-- The review box -->
	
<table metal:define-macro="review_box"
       class="box" 
       summary="Review listing" 
       cellpadding="0" cellspacing="0"
       tal:define="DateTime python:modules['DateTime'].DateTime;
                   results here/my_worklist;"
       tal:condition="results" >
        
    <thead>
        <tr><th>Review List</th><th class="empty">&nbsp;</th></tr>
    </thead>
        
    <tbody tal:repeat="o results">
        
        <tr tal:define="oddrow repeat/o/odd"
            tal:attributes="class python:test(oddrow, 'odd','even')" class="#">
			
            <td colspan="2"
                tal:define="actions python:container.portal_actions.listFilteredActionsFor(o);">
               
                <a href="#" tal:attributes="href python:container.getActionUrlById('view', actions['object'])">
                    <span tal:replace="python:test(o.Title(), o.Title(), o.id)">
                    Extended Calendar Product
                    </span>
                </a>

                <div class="boxDetails"
                     tal:content="python:DateTime(o.ModificationDate()).strftime('%B %d, %H:%M')">July 7, 08:11</div>
            </td>
			
        </tr>
    
    </tbody>
       
</table>

<!-- CMFTopic based navigation box -->
<table class="box" summary="Navigation listing" cellpadding="0" cellspacing="0"
       metal:define-macro="CMFTopic_navigation_box"
       tal:define="results python:here.portal_catalog(meta_type='Portal Topic',sort_on='id');
                   pss modules/Products/PythonScripts/standard;
                   showNav python:0;
                   showNav here/portal_url/CMFTopic_navigator | showNav"
       tal:condition="python:results and here.meta_type!='Portal Topic' and showNav">
       <!-- We don't show this box when we are editing a Portal Topic
            This is because it would lead to infinate recursion -->

  <span tal:define="navExpand python:request.SESSION.get('navExpand', results[0].Title)">
   <tr><th>navigation</th><th class="empty">&nbsp;</th></tr>
   <span tal:repeat="topic results">
    <tr>
      <td nowrap colspan="2">
        <a href="#" class="plain" tal:attributes="href python:here.navigatorExpand.absolute_url()+'?topic='+pss.url_quote(topic.Title)"
                                  tal:content="topic/Title">I am a navigation box</a>
        <span tal:define="obj python:topic.getObject()">
        <span tal:omit-tag="" tal:repeat="item python:obj.queryCatalog()"
                              tal:condition="obj">
          <span tal:omit-tag="" tal:condition="python:item.Title and navExpand==topic.Title">
            <br>
            <a href="#" tal:attributes="href python:item.getObject().absolute_url()"
                        tal:content="item/Title">&nbsp;</a>
          </span>
        </span>
        </span>
      </td>
    </tr>
   </span>
  </span>
</table>

        
<div metal:define-macro="calendarDatePickerBox">

 <comment tal:condition="nothing">
 
 This template relies on the presence of an 'inputname' variable, 
 which contains the name of the element whose value should be
 altered when the calendar returns a result.
 Similarly it requires a 'formname' variable - the name
 of the form in which this input element resides.
 Also it should be provided with inputvalue which is the
 current or default value for the field.
 
 </comment>
 
  <input type=text tal:attributes="name inputname; id inputname; value inputvalue">

  <a href="" tal:attributes="onclick string:window.open('plone_calendar/calendar_popup?inputname=${inputname}&formname=${formname}','cal','dependent=yes,width=180,height=160,screenX=200,screenY=300,titlebar=yes');; return false">
    <img src="plone_images/popup_calendar.gif">
  </a>


 
</div>


<div metal:define-macro="calendarDatePickerBoxPopup"
     class="container"
     tal:define="DateTime python:modules['DateTime'].DateTime;
                 current python:DateTime();
                 month python:request.get('month', DateTime().month());
                 year python:request.get('year', DateTime().year());
                 prevMonthTime python:here.getPreviousMonth(month, year);
                 nextMonthTime python:here.getNextMonth(month, year);
                 weeks python:here.portal_calendar.getWeeksList(month=month, year=year);">

    <table cellpadding="2" cellspacing="0" border="0" class="calendar" id="thecalendar">
        <tr tal:define="calendarurl python:'%s?inputname=%s&formname=%s' % (path('template/absolute_url'),inputname,formname) ">
            <th>
                <a href="" tal:attributes="href python:'%s&month:int=%d&year:int=%d' % (calendarurl,prevMonthTime.month(),prevMonthTime.year())">&laquo;</a>
            </th>
            <th colspan="5" tal:define="date string:$month/1/$year">
              <span tal:replace="python:DateTime(date).Month()"/> - <span tal:replace="python:DateTime(date).year()"/>
            </th>
        
            <th>
                <a href="" tal:attributes="href python:'%s&month:int=%d&year:int=%d' % (calendarurl,nextMonthTime.month(),nextMonthTime.year())">&raquo;</a>
            </th>
        </tr>
        
        <tr tal:define="weekdays here/portal_calendar/getDays">
          <span tal:repeat="weekday weekdays" tal:omit-tag="">
            <td class="weekdays" tal:content="weekday">Su</td>
          </span>
        </tr>
            <tr tal:repeat="week weeks">
              <span tal:define="days week" tal:omit-tag="">
                <span tal:repeat="day days" tal:omit-tag="">
                  <td tal:condition="not: python: day">
                    &nbsp;
                  </td>
                  <td class="noevent" tal:condition="python: day"
                                      tal:define="datestring python:'%d/%0.2d/%0.2d'%(year,month,day)"
                                      tal:attributes="class python:test(current.year()==year and current.month()==month and current.day()==int(day), 'todaynoevent', 'noevent')">
                    <a href="" tal:attributes="onclick string:returndate('${datestring}');; return false" tal:content="day">
                      day number
                    </a>
                  </td>
                </span>
              </span>
            </tr>
    
    </table>

</div>  <!-- end of the calendar datepicker box -->




<div metal:define-macro="calendarBox"
     class="container"
     tal:define="DateTime python:modules['DateTime'].DateTime;
                 current python:DateTime();
                 month python:request.get('month', DateTime().month());
                 year python:request.get('year', DateTime().year());
                 prevMonthTime python:here.getPreviousMonth(month, year);
                 nextMonthTime python:here.getNextMonth(month, year);
                 weeks python:here.portal_calendar.getEventsForCalendar(month=month, year=year);">


         

    <!-- The calendar, rendered as a table -->     

    <table cellpadding="2" cellspacing="0" border="0" class="calendar" id="thecalendar">
        
        <tr>
            <th>
                <a href="#" tal:attributes="href python:'%s?month:int=%d&year:int=%d' % (here.absolute_url()+'/'+template.getId(),prevMonthTime.month(),prevMonthTime.year())">&laquo;</a>
            </th>
        
            <th colspan="5" tal:define="date string:$month/1/$year">
              <span tal:replace="python:DateTime(date).strftime('%B').capitalize()"/> <span tal:replace="python:DateTime(date).year()"/>
            </th>
        
            <th>
                <a href="#" tal:attributes="href python:'%s?month:int=%d&year:int=%d' % (here.absolute_url()+'/'+template.getId(),nextMonthTime.month(),nextMonthTime.year())">&raquo;</a>
            </th>
        
        <tr tal:define="weekdays here/portal_calendar/getDays">
          <span tal:repeat="weekday weekdays" tal:omit-tag="">
            <td class="weekdays" tal:content="weekday">Su</td>
          </span>
        </tr>
        
            <tr tal:repeat="week weeks">
              <span tal:define="days week" tal:omit-tag="">
                <span tal:repeat="day days" tal:omit-tag="">
                  <span tal:condition="day/event" tal:omit-tag="">
                  <span tal:define="daynumber day/day;
                                    datestring python: '%d%0.2d%0.2d' % (year, month, daynumber);
                                    javascriptstring string:javascript:%sDay('%s');;">
                       
                  <td class="event"
                      tal:attributes="onMouseOut  python: javascriptstring % ('hide', datestring);
                                      onMouseOver python: javascriptstring % ('show', datestring);
                                      class       python:test(current.year()==year and current.month()==month and current.day()==int(daynumber), 'todayevent', 'event')">
                    <span tal:define="begEndTimes python:here.getBeginAndEndTimes(day=day['day'], month=month, year=year)" tal:omit-tag="">
                      <span tal:define="begin python:begEndTimes[0].ISO();
                                        end python:begEndTimes[1].ISO();
                                        pss python:modules['Products'].PythonScripts.standard" tal:omit-tag="">
                      <a href tal:attributes="href python:here.portal_url()+'/search?start:list:date=%s&start:list:date=%s&start_usage=range:min:max'%(pss.url_quote(begin),pss.url_quote(end))"> 
                        <span tal:replace="python: day['day'] or default">&nbsp;</span>
                      </a>
                      </span>
                    </span>
                    
                  </td>
                  </span>
                  </span>
                  <td tal:condition="not: day/event"
                                      tal:content="python: day['day'] or default"
                                      tal:attributes="class python:test(current.year()==year and current.month()==month and current.day()==int(day['day']), 'todaynoevent', '')">
                    &nbsp;
                  </td>
                </span>
              </span>
            </tr>
    
    </table>

    <comment tal:condition="nothing">
<!-- This style section has to be created dynamically, it's responsible
		 for offsetting the different yellow boxes. The algorithm is 
		 illustrated in the comments of the first one. -->

    <!-- This how the positions get calculated     

          #day20010411 {
              position: absolute;
              top: 10em;  /* (2 + (2 * row)) em */
              left: 7em; /* (3 + (column*2)) em */
          } 
    -->

    </comment>

    <!-- The sticky notes -->
    <span tal:repeat="week weeks" tal:omit-tag="">
      <span tal:define="days week" tal:omit-tag="">
        <span tal:repeat="day days" tal:omit-tag="">

          <div class="day" id="day20010411" tal:attributes="id python:'day%d%0.2d%0.2d' % (year, month, day['day']) "
               tal:condition="day/event">

            <div class="date" tal:content="python:'%d-%0.2d-%0.2d' % (year, month, day['day'])">
              2001-04-11
            </div>

              <span tal:repeat="anevent day/eventslist" tal:omit-tag="">
                <div class="appointment" tal:content="python: here.getEventString(event=anevent)">an event</div>
              </span>
          </div>

        </span>
      </span>
    </span>
<!--    
    <style type="text/css" tal:content="python: here.getPopupPositionStyles(weeks=weeks, year=year, month=month)">
    </style> 
-->
    

</div>



<html>
