<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      i18n:domain="plone">

<body>

<!-- THE STATUS MESSAGE DEFINITION -->
<tal:block i18n:domain="plone"
           metal:define-macro="portal_message">

    <tal:block tal:define="portal_message request/portal_status_message | nothing"
               tal:condition="portal_message">

        <div class="portalMessage">
            <tal:msg tal:content="portal_message" i18n:translate="">Portal Message</tal:msg>
        </div>

        <div class="portalMessage" tal:condition="python:putils.getDevelopmentMode()">
            An installed Product is using a deprecated method to display the
            above portal message.

            <hr />Please update your products to use PloneTool.addPortalMessage().
            The above message was instead shown by the deprecated method of
            adding '?portal_status_message=...'  to the URL. This method will
            not be supported in future Plone versions, as it makes the resulting
            page problematic to bookmark (in addition to other problems).
 
            <hr />This deprecation message is only shown while Zope is running
            in development or debug mode. To disable it even while in
            development mode, modify the global_statusmessage.pt page template.
        </div>
    </tal:block>

    <tal:block tal:define="messages python: putils.showPortalMessages()"
               tal:repeat="message messages">
        <tal:block
             tal:define="type_css_map python: {'info':'portalMessage',
                                               'warn':'portalWarningMessage',
                                               'stop':'portalStopMessage'
                                              };
                         mtype message/type | nothing;">
            <div class=""
                 tal:attributes="class python:mtype and type_css_map[mtype] or 'info';"
                 tal:content="message/message | nothing"
                 i18n:translate="">
                Message
            </div>

        </tal:block>
    </tal:block>
</tal:block>
</body>
</html>
