<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal">
<body>

<!-- Navigation -->
<div class="listingBar" 
     metal:define-macro="navigation"
     tal:define="request request|here/request|container/request|nothing;
                 batch batch|nothing;
                 mq python:modules['ZTUtils'].make_query;
                 url python:template.absolute_url();
                 currentpage batch/pagenumber;"
     tal:condition="python:test(batch.previous or batch.next, 1, 0)">

    <span class="previous" 
      tal:define="p batch/previous | nothing" 
      tal:condition="p"> 
        <a href=""
           tal:attributes="href python: '%s?' % url + mq( request.form, b_start=p.first )">
           &laquo;
           <span i18n:translate="batch_previous" omit-tag="">Previous</span>
           <span tal:replace="p/length">n</span> 
           <span i18n:translate="batch_items" omit-tag="">items</span>
        </a>
    </span>

    <!-- Link to first -->
    <span tal:condition="python: 1 not in batch.navlist">
        <a href="" 
           tal:attributes="href python: '%s?%s' % (url, batch.pageurl(request.form,1));"><span i18n:translate="batch_first_page" omit-tag="">First page</span>...</a>       
    </span>

    <!-- Pagelist for quick navigation -->
    <span tal:repeat="linklist python:batch.navurls(request.form)"
          tal:condition="batch/navlist" 
          tal:omit-tag="" >
        <span tal:define="page python:linklist[0];
                          query python:linklist[1];" >
        <span tal:omit-tag="" tal:condition="python: currentpage == page" tal:content="string:[$page]" />
        <a href=""
           tal:condition="python: currentpage != page"
           tal:content="page"
           tal:attributes="href python: '%s?%s' % (url,query)" ></a>
        </span>
    </span>

    <!-- Link to last -->
    <span tal:condition="python:batch.numpages not in batch.navlist">
        <a href="" 
           tal:attributes="href python: '%s?%s' % (url,batch.pageurl(request.form,batch.numpages));">...<span i18n:translate="batch_last_page" omit-tag="">Last page</span></a>       
    </span>

    <span class="next" 
      tal:define="n batch/next | nothing" 
      tal:condition="n">
        <a href=""
           tal:attributes="href python: '%s?' % url + mq( request.form, b_start=n.first )">
           <span i18n:translate="batch_next" omit-tag="">Next</span>
           <span tal:replace="n/length">n</span> 
           <span i18n:translate="batch_items" omit-tag="">items</span>
           &raquo;
        </a>
    </span>
 
</div>

</body>
</html>