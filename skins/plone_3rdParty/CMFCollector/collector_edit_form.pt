<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<span tal:condition="nothing"
      tal:define="has_edit_priv nocall: here/edit">
  This span ensures that the visitor has edit privilege, by fetching - but not
  displaying - the protected collector.edit method.
</span>

<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="header">

<h1>Collector Configuration</h1>

</div>

<div metal:fill-slot="main">	  

<form class="group"
      action="collector_edit" 
      method="post">

    <span class="legend">Collector Details</span>
    
    <div class="row" 
         tal:attributes="style python:test(not getattr(here.portal_membership.getAuthenticatedMember(), 'visible_ids', ''),
                                      'visibility:hidden;;position:absolute;;left:0;;top:0', '')"
         tal:define="error_id errors/id | nothing;
                     id python:request.get('id', here.getId());"> 
        <div class="label required">
        
            <span i18n:translate="id">ID</span>
        
            <div id="id_help" 
                 i18:id="id_help"
                 class="help" 
                 style="visibility:hidden">
            Enter the ID of the document. This is the part that will show up as part
            of the web address. This should be short, descriptive
            and preferrably not contain spaces, underscores or mixed case. Example:
            "expense-report-2002"
            </div>
        </div>

        <div class="field"
              tal:attributes="class python:test(error_id, 'field error', 'field')" >

            <div tal:replace="error_id" />

            <input type="text" 
                   name="id" 
                   value="#"
                   size="30" 
                   tabindex="1"
                   onfocus="formtooltip('id_help',1)" 
                   onblur="formtooltip('id_help',0)"
                   tal:attributes="value id;"
                   />
        </div>

    </div>

    <div class="row">
        <div class="label"> Title </div> 
        <div class="field">
            <input type="text"
                   name="title"
                   value=""
                   tal:attributes="value here/title"
                   size="45" />
        </div>
    </div>

    <div class="row">
        <div class="label"> 
        Abbreviation 
        
        </div> 
        <div class="field">
            <input type="text"
                   name="abbrev"
                   value=""
                   tal:attributes="value here/abbrev|nothing"
                   size="5" /> 
            (Collector email subject-line prefix)
        </div>
    </div>
  
    <div class="row">
        <div class="label"> Description </div> 
        <div class="field">
            <textarea name="description:text" rows="3"
                      cols="50"
                      tal:content="here/description">
            </textarea>
            (Will be rendered as HTML)
        </div>
    </div>
      
    <div class="row">
        <div class="label"> Collector email </div> 
        <div class="field"
             tal:define="member python: here.portal_membership.getAuthenticatedMember();
                         getpropemail python: hasattr(member, 'getProperty')
                                              and member.getProperty('email', '');
                         attremail python: getattr(member, 'email', '');
                         email python: getattr(here, 'email', 
                                                getpropemail or attremail)">
            
            <input type="text" 
                   name="email" 
                   size=25
                   value="EMAIL"
                   tal:attributes="value email" />
            (Collector email "From" address)
                            
        </div>
    </div>
  
    <div class="row">
        <div class="label"> Managers </div> 
        <div class="field">
            <textarea name="managers:lines" rows="5" cols="15">
<span tal:repeat="it here/managers" tal:replace="it"></span></textarea>
            Managers configure the collector, and receive request notices.
            Managers can accept issues, but must be on Supporters roster to be
            assigned.  (Managers cannot remove <em>themselves</em> from the
            management roster.)
        </div>
    </div>

    <div class="row">
        <div class="label"> Supporters </div> 
        <div class="field">
            <textarea name="supporters:lines" rows="5" cols="15">
<span tal:repeat="it here/supporters" tal:replace="it"></span></textarea>
            Supporters can be assigned to requests.  They may or may not
            receive initial request notifications, depending on the
            "dispatching" setting below.
        </div>
    </div>
  
    <div class="row">
        <div class="label"> Dispatcher Mode </div> 
        <div class="field">
            <div style="float:left">
            <input class="noborder"
                   type="radio" 
                   name="dispatching:int" 
                   value="0"
                   tal:attributes="checked not: here/dispatching|nothing" />
            Off (Managers and supporters receive pending-issue notices)
            
            <br />
            
            <input class="noborder"
                   type="radio" 
                   name="dispatching:int" 
                   value="1"
                   tal:attributes="checked here/dispatching|nothing" />
            On (Only managers receive pending-issue notices)
            </div>
        </div>
    </div>

    <div class="row">
        <div class="label"> Participation Mode </div> 
        <div class="field">
            <div style="float: left">
                <input class="noborder" 
                       type="radio" 
                       name="participation:string" 
                       value="staff"
                       tal:attributes="checked python: here.participation
                                                       == 'staff'">
                  Staff

                  (Only collector staff and issue requester participate in an
                  issue)

                <br />
                
                <input class="noborder" 
                       type="radio" 
                       name="participation:string"
                       value="authenticated"
                       tal:attributes="checked python: here.participation
                                                       == 'authenticated'">
                  Authenticated

                  (Any non-anonymous visitors can participate)

                <br />
                
                <input class="noborder" 
                       type="radio" 
                       name="participation:string" 
                       value="anyone"
                       tal:attributes="checked python: here.participation
                                                       == 'anyone'">
                  Anyone

                  (Anyone, including anonymous visitors, can chime in)
            </div>
        </div>
    </div>

    <div class="row">
        <div class="label"> Notifications </div> 
        <div class="field">
            <div style="float:left">
            <metal:block tal:define="states here/issue_states;"
                         tal:repeat="state states">

                <span tal:replace="state">State:</span>
                
                <br />
                
                <input type="text" 
                       size="30" 
                       name="stateemail" 
                       value=""
                       tal:attributes="name python: 'state_email.' + state
                                                    + ':record';
                                       value python: here.state_email.get(state, '')" />
                <br />
                                                
            </metal:block>
            </div>
            Fill in addresses next to the state names to have notifications for 
            issues in that state sent to those addresses (this is in addition to 
            normal issue-participant notifications)
        </div>
    </div>

    <div class="row">
        <div class="label"> Selections </div> 
        <div class="field">
            <div style="float: left">
            
            Topics
            <textarea name="topics:lines" rows="5" cols="15">
<span tal:repeat="it here/topics|nothing" tal:replace="it"></span></textarea>
            
            Classifications
            <textarea name="classifications:lines" rows="5" cols="15">
<span tal:repeat="it here/classifications|nothing" tal:replace="it"></span></textarea>
            
            Importance 
            <textarea name="importances:lines" rows="5" cols="15">
<span tal:repeat="it here/importances|nothing" tal:replace="it"></span></textarea>
            </div>
            (Fill in the alternatives for issue categorization)
        </div>
    </div>

    <div class="row">
        <div class="label"> Version boilerplate </div> 
        <div class="field">
   <textarea name="version_info_spiel:text" rows="3" cols="50">
<span tal:replace="here/version_info_spiel|nothing">
</span></textarea>
        (Something to prompt posters for useful version info)
        </div>
    </div>
 
    <div class="row">
        <div class="label"> Reinstate catalog </div> 
        <div class="field">
            <div style="float: left">
                <input class="noborder" type="radio" name="recatalog:int" value="0" checked="checked" /> No <br />
                <input class="noborder" type="radio" name="recatalog:int" value="1"> Internal only <br />
                <input class="noborder" type="radio" name="recatalog:int" value="2"> Internal &amp; Site-wide
                (slow) <br />
            </div>
                (Occasionally, product updates require internal catalog reinit and
                reindex and other existing-issue adjustment.  Collector product
                RELEASE_NOTES.txt will indicate when necessary.)
        </div>
    </div>

    <div class="row">
        <div class="label"> &nbsp; </div> 
        <div class="field">
            <input class="context" type="submit" value="Submit" />
            <input class="standalone" type="reset" value="Reset" />
        </div>
    </div>

</form>

</div>

</body>
</html>
