<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

    !! NOTICE !!
    This PageTemplate is being deprecated.  We have moved all 
    macros to their own PageTemplates in portal_templates/ui_slots.  
    Eventually this PageTemplate will be gone.

    the calendar UI widget can be found in plone_templates/ui_slots/calendar_slot

<!-- calendar box picker -->        
<div metal:define-macro="calendarDatePickerBox">

 <comment tal:condition="nothing">
 
 This template relies on the presence of an 'inputname' variable, 
 which contains the name of the element whose value should be
 altered when the calendar returns a result.
 Similarly it requires a 'formname' variable - the name
 of the form in which this input element resides.
 Also it should be provided with inputvalue which is the
 current or default value for the field.

 onfocus and/or onblur are setup as attributes if availabe. 
 
 tabindex is setup is provided.

 </comment>
 
  <input type=text tal:attributes="name inputname; 
                                   id inputname; 
                                   value inputvalue;
                                   onfocus onfocus|nothing;
                                   onblur onblur|nothing;
                                   tabindex tabindex|nothing" />

  <a href="" tal:attributes="onclick string:window.open('calendar_popup?inputname=${inputname}&formname=${formname}','cal','dependent=yes,width=180,height=160,screenX=200,screenY=300,titlebar=yes');; return false">
    <img src="popup_calendar.gif"
         tal:attributes="src string:${here/portal_url}/popup_calendar.gif" />
  </a>


 
</div>


<div metal:define-macro="calendarDatePickerBoxPopup"
     class="container"
     tal:define="DateTime python:modules['DateTime'].DateTime;
                 current python:DateTime();
                 month python:request.get('month', DateTime().month());
                 year python:request.get('year', DateTime().year());
                 prevMonthTime python:here.getPreviousMonth(month, year);
                 nextMonthTime python:here.getNextMonth(month, year);
                 weeks python:here.portal_calendar.getWeeksList(month=month, year=year);">

    <table cellpadding="2" cellspacing="0" border="0" class="calendar" id="thecalendar">
        <tr tal:define="calendarurl python:'%s?inputname=%s&formname=%s' % (path('template/absolute_url'),inputname,formname) ">
            <th>
                <a href="" tal:attributes="href python:'%s&month:int=%d&year:int=%d' % (calendarurl,prevMonthTime.month(),prevMonthTime.year())">&laquo;</a>
            </th>
            <th colspan="5" tal:define="date string:$month/1/$year">
              <span tal:replace="python:DateTime(date).Month()"/> - <span tal:replace="python:DateTime(date).year()"/>
            </th>
        
            <th>
                <a href="" tal:attributes="href python:'%s&month:int=%d&year:int=%d' % (calendarurl,nextMonthTime.month(),nextMonthTime.year())">&raquo;</a>
            </th>
        </tr>
        
        <tr tal:define="weekdays here/portal_calendar/getDays">
          <span tal:repeat="weekday weekdays" tal:omit-tag="">
            <td class="weekdays" tal:content="weekday">Su</td>
          </span>
        </tr>
            <tr tal:repeat="week weeks">
              <span tal:define="days week" tal:omit-tag="">
                <span tal:repeat="day days" tal:omit-tag="">
                  <td tal:condition="not: python: day">
                    &nbsp;
                  </td>
                  <td class="noevent" tal:condition="python: day"
                                      tal:define="datestring python:'%d/%0.2d/%0.2d'%(year,month,day)"
                                      tal:attributes="class python:test(current.year()==year and current.month()==month and current.day()==int(day), 'todaynoevent', 'noevent')">
                    <a href="" tal:attributes="onclick string:returndate('${datestring}');; return false" tal:content="day">
                      day number
                    </a>
                  </td>
                </span>
              </span>
            </tr>
    
    </table>

</div>  <!-- end of the calendar datepicker box -->

<html>
